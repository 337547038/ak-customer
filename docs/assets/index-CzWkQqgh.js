import{d as xe,q as et,E as F,r as K,c as oe,o as Z,L as ct,n as ut,P as tt,i as D,h as z,t as Ae,e as rt,g as H,F as nt,x as ae,T as lt,_ as ft,m as dt,W as pt,w as ht,a as vt,V as mt,b as gt,R as yt,X as qe,Y as wt}from"./index-CNiyTwfQ.js";import{v as te}from"./validate-BPUuIrlQ.js";var ce={exports:{}},Me;function Lt(){return Me||(Me=1,(function(i){var o=(function(n){var u=Object.prototype,s=u.hasOwnProperty,f=Object.defineProperty||function(t,e,r){t[e]=r.value},h,R=typeof Symbol=="function"?Symbol:{},N=R.iterator||"@@iterator",P=R.asyncIterator||"@@asyncIterator",M=R.toStringTag||"@@toStringTag";function E(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{E({},"")}catch{E=function(e,r,c){return e[r]=c}}function y(t,e,r,c){var a=e&&e.prototype instanceof _?e:_,v=Object.create(a.prototype),O=new x(c||[]);return f(v,"_invoke",{value:ie(t,r,O)}),v}n.wrap=y;function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(c){return{type:"throw",arg:c}}}var m="suspendedStart",g="suspendedYield",w="executing",k="completed",S={};function _(){}function L(){}function A(){}var Y={};E(Y,N,function(){return this});var J=Object.getPrototypeOf,$=J&&J(J(ee([])));$&&$!==u&&s.call($,N)&&(Y=$);var U=A.prototype=_.prototype=Object.create(Y);L.prototype=A,f(U,"constructor",{value:A,configurable:!0}),f(A,"constructor",{value:L,configurable:!0}),L.displayName=E(A,M,"GeneratorFunction");function Q(t){["next","throw","return"].forEach(function(e){E(t,e,function(r){return this._invoke(e,r)})})}n.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===L||(e.displayName||e.name)==="GeneratorFunction":!1},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,E(t,M,"GeneratorFunction")),t.prototype=Object.create(U),t},n.awrap=function(t){return{__await:t}};function V(t,e){function r(v,O,T,q){var C=d(t[v],t,O);if(C.type==="throw")q(C.arg);else{var l=C.arg,p=l.value;return p&&typeof p=="object"&&s.call(p,"__await")?e.resolve(p.__await).then(function(b){r("next",b,T,q)},function(b){r("throw",b,T,q)}):e.resolve(p).then(function(b){l.value=b,T(l)},function(b){return r("throw",b,T,q)})}}var c;function a(v,O){function T(){return new e(function(q,C){r(v,O,q,C)})}return c=c?c.then(T,T):T()}f(this,"_invoke",{value:a})}Q(V.prototype),E(V.prototype,P,function(){return this}),n.AsyncIterator=V,n.async=function(t,e,r,c,a){a===void 0&&(a=Promise);var v=new V(y(t,e,r,c),a);return n.isGeneratorFunction(e)?v:v.next().then(function(O){return O.done?O.value:v.next()})};function ie(t,e,r){var c=m;return function(v,O){if(c===w)throw new Error("Generator is already running");if(c===k){if(v==="throw")throw O;return ne()}for(r.method=v,r.arg=O;;){var T=r.delegate;if(T){var q=W(T,r);if(q){if(q===S)continue;return q}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(c===m)throw c=k,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);c=w;var C=d(t,e,r);if(C.type==="normal"){if(c=r.done?k:g,C.arg===S)continue;return{value:C.arg,done:r.done}}else C.type==="throw"&&(c=k,r.method="throw",r.arg=C.arg)}}}function W(t,e){var r=e.method,c=t.iterator[r];if(c===h)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=h,W(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),S;var a=d(c,t.iterator,e.arg);if(a.type==="throw")return e.method="throw",e.arg=a.arg,e.delegate=null,S;var v=a.arg;if(!v)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,S;if(v.done)e[t.resultName]=v.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=h);else return v;return e.delegate=null,S}Q(U),E(U,M,"Generator"),E(U,N,function(){return this}),E(U,"toString",function(){return"[object Generator]"});function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function X(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}n.keys=function(t){var e=Object(t),r=[];for(var c in e)r.push(c);return r.reverse(),function a(){for(;r.length;){var v=r.pop();if(v in e)return a.value=v,a.done=!1,a}return a.done=!0,a}};function ee(t){if(t){var e=t[N];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,c=function a(){for(;++r<t.length;)if(s.call(t,r))return a.value=t[r],a.done=!1,a;return a.value=h,a.done=!0,a};return c.next=c}}return{next:ne}}n.values=ee;function ne(){return{value:h,done:!0}}return x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(X),!t)for(var e in this)e.charAt(0)==="t"&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=h)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(q,C){return v.type="throw",v.arg=t,e.next=q,C&&(e.method="next",e.arg=h),!!C}for(var c=this.tryEntries.length-1;c>=0;--c){var a=this.tryEntries[c],v=a.completion;if(a.tryLoc==="root")return r("end");if(a.tryLoc<=this.prev){var O=s.call(a,"catchLoc"),T=s.call(a,"finallyLoc");if(O&&T){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(O){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else if(T){if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r];if(c.tryLoc<=this.prev&&s.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var a=c;break}}a&&(t==="break"||t==="continue")&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var v=a?a.completion:{};return v.type=t,v.arg=e,a?(this.method="next",this.next=a.finallyLoc,S):this.complete(v)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),S},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),X(r),S}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var c=r.completion;if(c.type==="throw"){var a=c.arg;X(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:ee(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=h),S}},n})(i.exports);try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}})(ce)),ce.exports}var ue,Ne;function Te(){return Ne||(Ne=1,ue=(i,o)=>`${i}-${o}-${Math.random().toString(16).slice(3,8)}`),ue}var le,Pe;function ot(){if(Pe)return le;Pe=1;const i=Te();let o=0;return le=({id:n,action:u,payload:s={}})=>{let f=n;return typeof f>"u"&&(f=i("Job",o),o+=1),{id:f,action:u,payload:s}},le}var re={},Ie;function Ce(){if(Ie)return re;Ie=1;let i=!1;return re.logging=i,re.setLogging=o=>{i=o},re.log=(...o)=>i?console.log.apply(this,o):null,re}var fe,Ge;function St(){if(Ge)return fe;Ge=1;const i=ot(),{log:o}=Ce(),n=Te();let u=0;return fe=()=>{const s=n("Scheduler",u),f={},h={};let R=[];u+=1;const N=()=>R.length,P=()=>Object.keys(f).length,M=()=>{if(R.length!==0){const g=Object.keys(f);for(let w=0;w<g.length;w+=1)if(typeof h[g[w]]>"u"){R[0](f[g[w]]);break}}},E=(g,w)=>new Promise((k,S)=>{const _=i({action:g,payload:w});R.push(async L=>{R.shift(),h[L.id]=_;try{k(await L[g].apply(this,[...w,_.id]))}catch(A){S(A)}finally{delete h[L.id],M()}}),o(`[${s}]: Add ${_.id} to JobQueue`),o(`[${s}]: JobQueue length=${R.length}`),M()});return{addWorker:g=>(f[g.id]=g,o(`[${s}]: Add ${g.id}`),o(`[${s}]: Number of workers=${P()}`),M(),g.id),addJob:async(g,...w)=>{if(P()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return E(g,w)},terminate:async()=>{Object.keys(f).forEach(async g=>{await f[g].terminate()}),R=[]},getQueueLen:N,getNumWorkers:P}},fe}function kt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var de,je;function _t(){return je||(je=1,de=i=>{const o={};return typeof WorkerGlobalScope<"u"?o.type="webworker":typeof document=="object"?o.type="browser":typeof process=="object"&&typeof kt=="function"&&(o.type="node"),typeof i>"u"?o:o[i]}),de}var pe,De;function bt(){if(De)return pe;De=1;const o=_t()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return pe=n=>{const u={...n};return["corePath","workerPath","langPath"].forEach(s=>{n[s]&&(u[s]=o(u[s]))}),u},pe}var he,Ue;function at(){return Ue||(Ue=1,he={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),he}const Et="6.0.1",Rt={version:Et};var ve,We;function Ot(){return We||(We=1,ve={workerBlobURL:!0,logger:()=>{}}),ve}var me,Be;function Tt(){if(Be)return me;Be=1;const i=Rt.version;return me={...Ot(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${i}/dist/worker.min.js`},me}var ge,Fe;function Ct(){return Fe||(Fe=1,ge=({workerPath:i,workerBlobURL:o})=>{let n;if(Blob&&URL&&o){const u=new Blob([`importScripts("${i}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(u))}else n=new Worker(i);return n}),ge}var ye,$e;function At(){return $e||($e=1,ye=i=>{i.terminate()}),ye}var we,ze;function qt(){return ze||(ze=1,we=(i,o)=>{i.onmessage=({data:n})=>{o(n)}}),we}var Le,Ye;function Mt(){return Ye||(Ye=1,Le=async(i,o)=>{i.postMessage(o)}),Le}var Se,Ke;function Nt(){if(Ke)return Se;Ke=1;const i=n=>new Promise((u,s)=>{const f=new FileReader;f.onload=()=>{u(f.result)},f.onerror=({target:{error:{code:h}}})=>{s(Error(`File could not be read! Code=${h}`))},f.readAsArrayBuffer(n)}),o=async n=>{let u=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?u=atob(n.split(",")[1]).split("").map(s=>s.charCodeAt(0)):u=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(u=await o(n.src)),n.tagName==="VIDEO"&&(u=await o(n.poster)),n.tagName==="CANVAS"&&await new Promise(s=>{n.toBlob(async f=>{u=await i(f),s()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const s=await n.convertToBlob();u=await i(s)}else(n instanceof File||n instanceof Blob)&&(u=await i(n));return new Uint8Array(u)};return Se=o,Se}var ke,He;function Pt(){if(He)return ke;He=1;const i=Tt(),o=Ct(),n=At(),u=qt(),s=Mt(),f=Nt();return ke={defaultOptions:i,spawnWorker:o,terminateWorker:n,onMessage:u,send:s,loadImage:f},ke}var _e,Je;function it(){if(Je)return _e;Je=1;const i=bt(),o=ot(),{log:n}=Ce(),u=Te(),s=at(),{defaultOptions:f,spawnWorker:h,terminateWorker:R,onMessage:N,loadImage:P,send:M}=Pt();let E=0;return _e=async(y="eng",d=s.LSTM_ONLY,m={},g={})=>{const w=u("Worker",E),{logger:k,errorHandler:S,..._}=i({...f,...m}),L={},A=typeof y=="string"?y.split("+"):y;let Y=d,J=g;const $=[s.DEFAULT,s.LSTM_ONLY].includes(d)&&!_.legacyCore;let U,Q;const V=new Promise((l,p)=>{Q=l,U=p}),ie=l=>{U(l.message)};let W=h(_);W.onerror=ie,E+=1;const I=({id:l,action:p,payload:b})=>new Promise((G,j)=>{n(`[${w}]: Start ${l}, action=${p}`);const B=`${p}-${l}`;L[B]={resolve:G,reject:j},M(W,{workerId:w,jobId:l,action:p,payload:b})}),X=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),x=l=>I(o({id:l,action:"load",payload:{options:{lstmOnly:$,corePath:_.corePath,logging:_.logging}}})),ee=(l,p,b)=>I(o({id:b,action:"FS",payload:{method:"writeFile",args:[l,p]}})),ne=(l,p)=>I(o({id:p,action:"FS",payload:{method:"readFile",args:[l,{encoding:"utf8"}]}})),t=(l,p)=>I(o({id:p,action:"FS",payload:{method:"unlink",args:[l]}})),e=(l,p,b)=>I(o({id:b,action:"FS",payload:{method:l,args:p}})),r=(l,p)=>I(o({id:p,action:"loadLanguage",payload:{langs:l,options:{langPath:_.langPath,dataPath:_.dataPath,cachePath:_.cachePath,cacheMethod:_.cacheMethod,gzip:_.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(Y)&&!_.legacyLang}}})),c=(l,p,b,G)=>I(o({id:G,action:"initialize",payload:{langs:l,oem:p,config:b}})),a=(l="eng",p,b,G)=>{if($&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(p))throw Error("Legacy model requested but code missing.");const j=p||Y;Y=j;const B=b||J;J=B;const se=(typeof l=="string"?l.split("+"):l).filter(st=>!A.includes(st));return A.push(...se),se.length>0?r(se,G).then(()=>c(l,j,B,G)):c(l,j,B,G)},v=(l={},p)=>I(o({id:p,action:"setParameters",payload:{params:l}})),O=async(l,p={},b={text:!0},G)=>I(o({id:G,action:"recognize",payload:{image:await P(l),options:p,output:b}})),T=async(l,p)=>{if($)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return I(o({id:p,action:"detect",payload:{image:await P(l)}}))},q=async()=>(W!==null&&(R(W),W=null),Promise.resolve());N(W,({workerId:l,jobId:p,status:b,action:G,data:j})=>{const B=`${G}-${p}`;if(b==="resolve")n(`[${l}]: Complete ${p}`),L[B].resolve({jobId:p,data:j}),delete L[B];else if(b==="reject")if(L[B].reject(j),delete L[B],G==="load"&&U(j),S)S(j);else throw Error(j);else b==="progress"&&k({...j,userJobId:p})});const C={id:w,worker:W,load:X,writeText:ee,readText:ne,removeFile:t,FS:e,reinitialize:a,setParameters:v,recognize:O,detect:T,terminate:q};return x().then(()=>r(y)).then(()=>c(y,d,g)).then(()=>Q(C)).catch(()=>{}),V},_e}var be,Ve;function It(){if(Ve)return be;Ve=1;const i=it();return be={recognize:async(u,s,f)=>{const h=await i(s,1,f);return h.recognize(u).finally(async()=>{await h.terminate()})},detect:async(u,s)=>{const f=await i("osd",0,s);return f.detect(u).finally(async()=>{await f.terminate()})}},be}var Ee,Ze;function Gt(){return Ze||(Ze=1,Ee={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Ee}var Re,Qe;function jt(){return Qe||(Qe=1,Re={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Re}var Oe,Xe;function Dt(){if(Xe)return Oe;Xe=1,Lt();const i=St(),o=it(),n=It(),u=Gt(),s=at(),f=jt(),{setLogging:h}=Ce();return Oe={languages:u,OEM:s,PSM:f,createScheduler:i,createWorker:o,setLogging:h,...n},Oe}var Ut=Dt();const Wt={class:"img-item"},Bt={class:"img-box"},Ft=["src"],$t={class:"file-name"},zt={class:"ocr-content"},Yt={class:"ocr-text"},Kt={class:"btn"},Ht=xe({__name:"card",props:{file:{default:()=>({})}},emits:["delClick"],setup(i,{emit:o}){const n=i,u=o,s=et(()=>{const{workerText:d,status:m}=n.file;return d||(m==="success"?"识别中...":"图片上传中..")}),f=F(!1),h=F(!1),R=F(),N=d=>d.status==="success"?"success":d.status==="fail"?"exception":"",P={name:[te("required","联系人姓名不能为空")],company:[te("required","客户名称不能为空")],phone:[te("required","联系人电话不能为空"),te("phone")],email:[te("email")]},M=F([{prop:"name",label:"姓名"},{prop:"company",label:"公司名称"},{prop:"phone",label:"手机号码"},{prop:"position",label:"职务"},{prop:"email",label:"邮箱"}]),E=()=>{h.value=!0,R.value.onSubmit().then(({data:d})=>{h.value=!1,f.value=!0,lt.success(d)}).catch(()=>{h.value=!1})},y=()=>!1;return(d,m)=>{const g=K("el-progress"),w=K("ak-form"),k=K("CircleCheck"),S=K("el-icon"),_=K("el-button");return Z(),oe("div",{class:ct(["progress-container",{"wap-container":ut(tt)()}])},[D("div",Wt,[D("div",Bt,[z(g,{percentage:i.file.percentage||0,status:N(i.file)},null,8,["percentage","status"]),D("img",{src:i.file.url,alt:""},null,8,Ft),D("div",$t,Ae(i.file.name),1)]),D("div",zt,[m[1]||(m[1]=D("p",null,"识别结果：",-1)),D("p",null,Ae(s.value),1)]),D("div",Yt,[m[2]||(m[2]=D("p",null,"提取结果",-1)),z(w,{ref_key:"formRef",ref:R,"model-value":i.file.model,"btn-text":!1,rules:P,"label-width":"90",after:y,api:{add:"customerScanCard"},data:M.value},null,8,["model-value","data"])]),D("div",Kt,[f.value?(Z(),rt(S,{key:0,size:"26px",color:"green"},{default:H(()=>[z(k)]),_:1})):(Z(),oe(nt,{key:1},[z(_,{type:"danger",onClick:m[0]||(m[0]=L=>u("delClick"))},{default:H(()=>[...m[3]||(m[3]=[ae(" 移除 ",-1)])]),_:1}),z(_,{type:"primary",loading:h.value,onClick:E},{default:H(()=>[...m[4]||(m[4]=[ae(" 一键入库 ",-1)])]),_:1},8,["loading"])],64))])])],2)}}}),Jt=ft(Ht,[["__scopeId","data-v-17ce0ae0"]]),Xt=xe({__name:"index",setup(i){const o=F(),n=F([]),u=F(),s=async()=>{u.value=await Ut.createWorker(["eng","chi_sim"],1,{workerPath:"/js/tesseract/worker.min.js",corePath:"/js/tesseract/tesseract-core-simd-lstm.wasm.js"})},f=F(!1),h=y=>{const{file:d,onProgress:m,onSuccess:g,onError:w}=y,k=F();n.value.forEach(L=>{L.uid===d.uid&&(L.status="uploading",k.value=L)});const S=new FormData;S.append("file",d),yt("upload",S,{onUploadProgress:L=>{const A=Math.round(L.loaded*100/L.total);k.value.percentage=A,m({percent:A},d)}}).then(async({data:L})=>{k.value.status="success",k.value.url=L,await R(L,k),g("上传成功",d),qe("fileList",n.value)}).catch(()=>{w("上传失败",d)})},R=async(y,d)=>{const m=await u.value.recognize(y);d.value.workerText=m.data.text,d.value.model=N(m.data.text),await u.value.terminate()},N=y=>{const d=y.match(/姓名[:：]\s*(\S+)/)||y.match(/^([^\d\n]+)\s*[\n\t]/),m=y.match(/职位[:：]\s*(\S+)/)||y.match(/(经理|总监|工程师|设计师)/),g=y.match(/公司[:：]\s*([^\n]+)/),w=y.match(/1[3-9]\d{9}/)||y.match(/\d{3,4}[- ]?\d{7,8}/),k=y.match(/\w+@\w+\.\w+/);return{name:d?d[1].trim():"",position:m?m[1].trim():"",company:g?g[1].trim():"",tel:w?w[0].trim():"",email:k?k[0].trim():""}},P=y=>{n.value.splice(y,1),qe("fileList",n.value)},M=()=>{n.value=[],wt("fileList"),o.value.clearFiles()};dt(()=>{s(),n.value=pt("fileList")||[]});const E=et(()=>tt()?{paddingTop:"10px",justifyContent:"center"}:{});return(y,d)=>{const m=K("el-button"),g=K("el-upload"),w=vt("loading");return ht((Z(),oe("div",null,[D("div",{style:mt([{display:"flex"},E.value])},[z(g,{ref_key:"uploadRef",ref:o,"file-list":n.value,"onUpdate:fileList":d[0]||(d[0]=k=>n.value=k),"show-file-list":!1,accept:"image/png, image/jpeg, image/jpg","http-request":h,multiple:""},{tip:H(()=>[...d[2]||(d[2]=[D("div",{class:"el-upload__tip"}," 支持jpg,png,jpeg图片格式 ",-1)])]),default:H(()=>[z(m,{type:"primary",icon:"upload-filled"},{default:H(()=>[...d[1]||(d[1]=[ae(" 选择名片 ",-1)])]),_:1})]),_:1},8,["file-list"]),z(m,{type:"danger",onClick:M},{default:H(()=>[...d[3]||(d[3]=[ae(" 清空 ",-1)])]),_:1})],4),(Z(!0),oe(nt,null,gt(n.value,(k,S)=>(Z(),rt(Jt,{key:S,file:k,onDelClick:_=>P(S)},null,8,["file","onDelClick"]))),128))])),[[w,f.value]])}}});export{Xt as default};
