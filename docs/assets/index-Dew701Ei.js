import{d as X,k as Y,E as a,q as f,p as ee,Q as C,c as _,f as te,h as l,n as D,P as oe,g as i,F as T,r,o as d,i as c,t as u,w as se,G as ae,Z as F,b as le,e as re,S as ne,R,T as B,J as ie,$ as ce,a0 as pe,_ as ue}from"./index-CNiyTwfQ.js";import{_ as V,f as me}from"./formData-D8zts8VD.js";import{g as L}from"./getCityByCode-DzjNnDGo.js";import{_ as de}from"./detailTabs.vue_vue_type_script_setup_true_lang-Md6tlvhs.js";import"./validate-BPUuIrlQ.js";import"./areas-c4JLuV3N.js";import"./index.vue_vue_type_script_setup_true_lang-BBm_6KhT.js";import"./index.vue_vue_type_script_setup_true_lang-BGeArx4B.js";import"./wap-Ds3eP_zq.js";import"./index.vue_vue_type_script_setup_true_lang-4ZSc0hEX.js";import"./index.vue_vue_type_script_setup_true_lang-DZJ_mQBD.js";import"./paymentForm.vue_vue_type_script_setup_true_lang-DZ5FNQgC.js";import"./wap-CzR0Kd7f.js";import"./upload.vue_vue_type_script_setup_true_lang-COSkoUoB.js";import"./index.vue_vue_type_script_setup_true_lang-NlBYEa1N.js";import"./wap.vue_vue_type_script_setup_true_lang-cgYc7xKY.js";import"./records-C3xKnzZs.js";const fe={key:0},_e=["onClick"],ye={class:"ul"},ve=X({__name:"index",props:{invalidPage:{type:Boolean}},setup(y){const M=Y(),S=y,v=a(),b=a(),m=f(()=>ee("delCustomer")),E=[{type:"selection",width:30},{label:"序号",type:"index",width:60},{prop:"company",label:"客户名称"},{prop:"industry",label:"行业分类",render:"tag",replaceValue:"industryType",search:{render:"select",options:"industryType"}},{prop:"area",label:"所属区域",search:{render:"component",component:C(V)},formatter:(t,e,o)=>L(o),showOverflowTooltip:!0},{prop:"operation",label:"操作",render:"buttons",search:!1,fixed:"right",buttons:[{key:"detail",label:"详情",icon:"",attr:{text:!0},click:t=>{v.value.openDrawer(!1,t||{},"")}},{key:"del",label:"删除",icon:"",attr:{text:!0},display:()=>m.value}]}],I=[{key:"toMy",label:"转入跟进",type:"primary",click:t=>{const e=t?.map(o=>o.id).join(",");R("customerMove",{ids:e,type:"toFollow"}).then(o=>{B.success(o.message||"转入成功"),b.value.getData()}).catch(o=>{B.success(o.message||"转入失败")})},disabled:t=>!t?.length},{key:"del",display:()=>m.value}],$=(t,e)=>(t==="get"&&(e.status=S.invalidPage?3:2,e.area&&(e.area=e.area.join(","))),e),k=a(),q=f(()=>M.getSystemDict()||{}),h=t=>ne(t,"{y}-{m}-{d} {h}:{i}"),p=a(),g=a([]),w=a([]),P=a([{prop:"company",label:"客户名称"},{prop:"area",label:"所属区域",render:"component",component:C(V)},{prop:"industry",label:"行业分类",render:"picker",options:"industryType"}]),N=a(!1),x=t=>{p.value.showForm(!0),ie(()=>{k.value.getData({id:t.id})})},z=f(()=>me.map(t=>{const e=Object.assign({},t);return e.formItem&&delete e.formItem,e.attr&&(e.field=e.attr,delete e.attr),e.visible&&delete e.visible,e.render==="select"&&(e.render="picker"),e})),O=()=>{p.value.showForm(!1)},U=a([{text:"详情",key:"detail",type:"primary"},{text:"转入跟进",key:"toFollow",type:"success"},{text:"删除",key:"del",type:"danger",visible:m.value}]),W=(t,e)=>{e==="detail"?x(t):e==="del"&&m.value?p.value.deleteById(t.id):e==="toFollow"&&R("customerMove",{ids:t.id+"",type:e}).then(o=>{ce(o.message||"转入成功"),p.value.onRefresh()}).catch(o=>{pe(o.message||"转入失败")})};return(t,e)=>{const o=r("ak-list"),j=r("van-checkbox"),A=r("van-collapse-item"),G=r("van-button"),J=r("van-swipe-cell"),Q=r("w-form"),Z=r("w-list"),H=r("van-checkbox-group"),K=r("van-collapse");return d(),_(T,null,[D(oe)()?te("",!0):(d(),_("div",fe,[l(o,{ref_key:"tableListEl",ref:b,pk:"id",columns:E,api:{list:"customerList",del:"customerDel"},"control-btn":I,before:$},null,512),l(de,{ref_key:"detailTableRef",ref:v,disabled:!0,"tabs-type":"shareWithMe"},null,512)])),l(K,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s)},{default:i(()=>[l(H,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=s=>w.value=s)},{default:i(()=>[l(Z,{ref_key:"listRef",ref:p,api:{get:"customerList",del:"customerDel"},"search-form-data":P.value,"add-icon-visible":!1,params:{status:y.invalidPage?3:2},"form-title":"详情"},{item:i(({data:s})=>[l(J,null,{right:i(()=>[(d(!0),_(T,null,le(U.value.filter(n=>n.visible!==!1),n=>(d(),re(G,{key:n.key,type:n.type,square:"",color:n.color,text:n.text,size:"small",onClick:be=>W(s,n.key)},null,8,["type","color","text","onClick"]))),128))]),default:i(()=>[l(A,{name:s.id},{title:i(()=>[se(l(j,{name:s.id,"icon-size":"16px",onClick:e[0]||(e[0]=F(()=>{},["stop"]))},null,8,["name"]),[[ae,N.value]]),c("span",{onClick:F(n=>x(s),["stop"])},u(s.company),9,_e)]),default:i(()=>[c("ul",ye,[c("li",null,"行业分类："+u(q.value.industryType[s.industry]),1),c("li",null,"所属区域："+u(D(L)(s.area)),1),c("li",null,"最近联系："+u(h(s.lastTime)),1),c("li",null,"更新时间："+u(h(s.updateTime)),1)])]),_:2},1032,["name"])]),_:2},1024)]),default:i(()=>[l(Q,{ref_key:"formRef",ref:k,data:z.value,"request-url":"customerDetail",disabled:!0,onCancel:O},null,8,["data"])]),_:1},8,["search-form-data","params"])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])],64)}}}),$e=ue(ve,[["__scopeId","data-v-0e0f0b43"]]);export{$e as default};
