import{d as C,m as I,r as l,s as R,e as B,o as N,b as u,g as a,w as m,a as c,h as S,H as A,x as D,B as G,u as M,D as p,G as P,_ as T,P as h}from"./index-BiMixNdo.js";import{W as U}from"./index-BRW3ffWd.js";const W={class:"container"},E={class:"form"},H=["src"],K={class:"weixin",style:{padding:"10px 0"}},v=C({__name:"index",setup(j){const f=M(),r=D(),y=I(),_=l(),b=()=>{_.value.open()},g=(t,e)=>{e?(A("resources",!0),y.setLoginInfo(t,!0),w(t.roleId).then(()=>{const o=r.query.redirect?r.query.redirect:"/";G(()=>{f.push({path:o})})})):n()},w=t=>new Promise(e=>{if(!t)return e();p("roleGetByIds",{id:t}).then(o=>{const d=o.data;P("resources",d,0),e()})}),s=l({userName:"admin",password:"123456"}),k=l([{prop:"userName",label:"用户名",formItem:{rules:[{required:!0,message:"请输入用户名",trigger:"blur"}]},attr:{}},{prop:"password",label:"密码",formItem:{rules:[{required:!0,message:"请输入密码",trigger:"blur"}]},attr:{type:"password"}}]),x=l(),n=()=>{p("getCaptcha",{}).then(t=>{const{base64:e,codeId:o}=t.data;x.value="data:image/png;base64,"+e,s.value.codeId=o}).catch(()=>{})},L=()=>{const t=r.query.code,e=r.query.state;t&&e&&p("scanLogin",{code:t}).then(o=>{g(o.data,!0)}).catch(()=>{f.push({path:"/login",query:{redirect:"/system/usercenter"}}),n()})};return R(()=>{n(),L()}),(t,e)=>{const o=c("el-input"),d=c("el-form-item"),V=c("ak-form"),q=c("el-button");return N(),B("div",W,[u("div",E,[e[3]||(e[3]=u("h3",null,"AK客户管理系统",-1)),a(V,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=i=>s.value=i),"label-width":"100",data:k.value,api:{add:"userLogin"},after:g},{default:m(()=>[a(d,{label:"验证码",class:"item-code"},{default:m(()=>[a(o,{modelValue:s.value.code,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value.code=i),placeholder:"输入验证码"},null,8,["modelValue"]),u("img",{src:x.value,class:"img",alt:"获取验证码",onClick:n},null,8,H)]),_:1})]),_:1},8,["modelValue","data"]),u("div",K,[a(q,{type:"primary",text:"",onClick:b},{default:m(()=>[...e[2]||(e[2]=[S(" 微信扫码登录 ",-1)])]),_:1})]),a(U,{ref_key:"wxLoginRef",ref:_},null,512)])])}}});typeof h=="function"&&h(v);const J=T(v,[["__scopeId","data-v-9575a2b3"]]);export{J as default};
