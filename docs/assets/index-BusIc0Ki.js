import{d as xe,q as it,v as W,r as K,c as oe,o as Z,i as j,h as z,t as Ce,e as et,g as H,F as tt,s as ae,E as st,_ as ut,m as ct,A as lt,w as ft,a as dt,b as pt,B as ht,C as qe,D as vt}from"./index-D65I1yai.js";import{v as te}from"./validate-DWZH7t8y.js";var ue={exports:{}},Ne;function mt(){return Ne||(Ne=1,(function(s){var o=(function(n){var c=Object.prototype,i=c.hasOwnProperty,f=Object.defineProperty||function(t,e,r){t[e]=r.value},y,b=typeof Symbol=="function"?Symbol:{},N=b.iterator||"@@iterator",I=b.asyncIterator||"@@asyncIterator",q=b.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch{p=function(e,r,u){return e[r]=u}}function v(t,e,r,u){var a=e&&e.prototype instanceof g?e:g,w=Object.create(a.prototype),O=new x(u||[]);return f(w,"_invoke",{value:ie(t,r,O)}),w}n.wrap=v;function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(u){return{type:"throw",arg:u}}}var _="suspendedStart",L="suspendedYield",m="executing",R="completed",k={};function g(){}function E(){}function M(){}var Y={};p(Y,N,function(){return this});var J=Object.getPrototypeOf,F=J&&J(J(ee([])));F&&F!==c&&i.call(F,N)&&(Y=F);var $=M.prototype=g.prototype=Object.create(Y);E.prototype=M,f($,"constructor",{value:M,configurable:!0}),f(M,"constructor",{value:E,configurable:!0}),E.displayName=p(M,q,"GeneratorFunction");function Q(t){["next","throw","return"].forEach(function(e){p(t,e,function(r){return this._invoke(e,r)})})}n.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===E||(e.displayName||e.name)==="GeneratorFunction":!1},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,p(t,q,"GeneratorFunction")),t.prototype=Object.create($),t},n.awrap=function(t){return{__await:t}};function V(t,e){function r(w,O,T,C){var A=h(t[w],t,O);if(A.type==="throw")C(A.arg);else{var l=A.arg,d=l.value;return d&&typeof d=="object"&&i.call(d,"__await")?e.resolve(d.__await).then(function(S){r("next",S,T,C)},function(S){r("throw",S,T,C)}):e.resolve(d).then(function(S){l.value=S,T(l)},function(S){return r("throw",S,T,C)})}}var u;function a(w,O){function T(){return new e(function(C,A){r(w,O,C,A)})}return u=u?u.then(T,T):T()}f(this,"_invoke",{value:a})}Q(V.prototype),p(V.prototype,I,function(){return this}),n.AsyncIterator=V,n.async=function(t,e,r,u,a){a===void 0&&(a=Promise);var w=new V(v(t,e,r,u),a);return n.isGeneratorFunction(e)?w:w.next().then(function(O){return O.done?O.value:w.next()})};function ie(t,e,r){var u=_;return function(w,O){if(u===m)throw new Error("Generator is already running");if(u===R){if(w==="throw")throw O;return ne()}for(r.method=w,r.arg=O;;){var T=r.delegate;if(T){var C=B(T,r);if(C){if(C===k)continue;return C}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(u===_)throw u=R,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);u=m;var A=h(t,e,r);if(A.type==="normal"){if(u=r.done?R:L,A.arg===k)continue;return{value:A.arg,done:r.done}}else A.type==="throw"&&(u=R,r.method="throw",r.arg=A.arg)}}}function B(t,e){var r=e.method,u=t.iterator[r];if(u===y)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=y,B(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),k;var a=h(u,t.iterator,e.arg);if(a.type==="throw")return e.method="throw",e.arg=a.arg,e.delegate=null,k;var w=a.arg;if(!w)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,k;if(w.done)e[t.resultName]=w.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=y);else return w;return e.delegate=null,k}Q($),p($,q,"Generator"),p($,N,function(){return this}),p($,"toString",function(){return"[object Generator]"});function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function X(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}n.keys=function(t){var e=Object(t),r=[];for(var u in e)r.push(u);return r.reverse(),function a(){for(;r.length;){var w=r.pop();if(w in e)return a.value=w,a.done=!1,a}return a.done=!0,a}};function ee(t){if(t){var e=t[N];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,u=function a(){for(;++r<t.length;)if(i.call(t,r))return a.value=t[r],a.done=!1,a;return a.value=y,a.done=!0,a};return u.next=u}}return{next:ne}}n.values=ee;function ne(){return{value:y,done:!0}}return x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=y,this.done=!1,this.delegate=null,this.method="next",this.arg=y,this.tryEntries.forEach(X),!t)for(var e in this)e.charAt(0)==="t"&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=y)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(C,A){return w.type="throw",w.arg=t,e.next=C,A&&(e.method="next",e.arg=y),!!A}for(var u=this.tryEntries.length-1;u>=0;--u){var a=this.tryEntries[u],w=a.completion;if(a.tryLoc==="root")return r("end");if(a.tryLoc<=this.prev){var O=i.call(a,"catchLoc"),T=i.call(a,"finallyLoc");if(O&&T){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(O){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else if(T){if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var u=this.tryEntries[r];if(u.tryLoc<=this.prev&&i.call(u,"finallyLoc")&&this.prev<u.finallyLoc){var a=u;break}}a&&(t==="break"||t==="continue")&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var w=a?a.completion:{};return w.type=t,w.arg=e,a?(this.method="next",this.next=a.finallyLoc,k):this.complete(w)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),X(r),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var u=r.completion;if(u.type==="throw"){var a=u.arg;X(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:ee(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=y),k}},n})(s.exports);try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}})(ue)),ue.exports}var ce,Ie;function Te(){return Ie||(Ie=1,ce=(s,o)=>`${s}-${o}-${Math.random().toString(16).slice(3,8)}`),ce}var le,Me;function rt(){if(Me)return le;Me=1;const s=Te();let o=0;return le=({id:n,action:c,payload:i={}})=>{let f=n;return typeof f>"u"&&(f=s("Job",o),o+=1),{id:f,action:c,payload:i}},le}var re={},Pe;function Ae(){if(Pe)return re;Pe=1;let s=!1;return re.logging=s,re.setLogging=o=>{s=o},re.log=(...o)=>s?console.log.apply(this,o):null,re}var fe,Ge;function gt(){if(Ge)return fe;Ge=1;const s=rt(),{log:o}=Ae(),n=Te();let c=0;return fe=()=>{const i=n("Scheduler",c),f={},y={};let b=[];c+=1;const N=()=>b.length,I=()=>Object.keys(f).length,q=()=>{if(b.length!==0){const L=Object.keys(f);for(let m=0;m<L.length;m+=1)if(typeof y[L[m]]>"u"){b[0](f[L[m]]);break}}},p=(L,m)=>new Promise((R,k)=>{const g=s({action:L,payload:m});b.push(async E=>{b.shift(),y[E.id]=g;try{R(await E[L].apply(this,[...m,g.id]))}catch(M){k(M)}finally{delete y[E.id],q()}}),o(`[${i}]: Add ${g.id} to JobQueue`),o(`[${i}]: JobQueue length=${b.length}`),q()});return{addWorker:L=>(f[L.id]=L,o(`[${i}]: Add ${L.id}`),o(`[${i}]: Number of workers=${I()}`),q(),L.id),addJob:async(L,...m)=>{if(I()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return p(L,m)},terminate:async()=>{Object.keys(f).forEach(async L=>{await f[L].terminate()}),b=[]},getQueueLen:N,getNumWorkers:I}},fe}function yt(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var de,De;function wt(){return De||(De=1,de=s=>{const o={};return typeof WorkerGlobalScope<"u"?o.type="webworker":typeof document=="object"?o.type="browser":typeof process=="object"&&typeof yt=="function"&&(o.type="node"),typeof s>"u"?o:o[s]}),de}var pe,je;function Lt(){if(je)return pe;je=1;const o=wt()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return pe=n=>{const c={...n};return["corePath","workerPath","langPath"].forEach(i=>{n[i]&&(c[i]=o(c[i]))}),c},pe}var he,$e;function nt(){return $e||($e=1,he={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),he}const _t="6.0.1",St={version:_t};var ve,Be;function kt(){return Be||(Be=1,ve={workerBlobURL:!0,logger:()=>{}}),ve}var me,Ue;function bt(){if(Ue)return me;Ue=1;const s=St.version;return me={...kt(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${s}/dist/worker.min.js`},me}var ge,We;function Et(){return We||(We=1,ge=({workerPath:s,workerBlobURL:o})=>{let n;if(Blob&&URL&&o){const c=new Blob([`importScripts("${s}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(c))}else n=new Worker(s);return n}),ge}var ye,Fe;function Rt(){return Fe||(Fe=1,ye=s=>{s.terminate()}),ye}var we,ze;function Ot(){return ze||(ze=1,we=(s,o)=>{s.onmessage=({data:n})=>{o(n)}}),we}var Le,Ye;function Tt(){return Ye||(Ye=1,Le=async(s,o)=>{s.postMessage(o)}),Le}var _e,Ke;function At(){if(Ke)return _e;Ke=1;const s=n=>new Promise((c,i)=>{const f=new FileReader;f.onload=()=>{c(f.result)},f.onerror=({target:{error:{code:y}}})=>{i(Error(`File could not be read! Code=${y}`))},f.readAsArrayBuffer(n)}),o=async n=>{let c=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?c=atob(n.split(",")[1]).split("").map(i=>i.charCodeAt(0)):c=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(c=await o(n.src)),n.tagName==="VIDEO"&&(c=await o(n.poster)),n.tagName==="CANVAS"&&await new Promise(i=>{n.toBlob(async f=>{c=await s(f),i()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const i=await n.convertToBlob();c=await s(i)}else(n instanceof File||n instanceof Blob)&&(c=await s(n));return new Uint8Array(c)};return _e=o,_e}var Se,He;function Ct(){if(He)return Se;He=1;const s=bt(),o=Et(),n=Rt(),c=Ot(),i=Tt(),f=At();return Se={defaultOptions:s,spawnWorker:o,terminateWorker:n,onMessage:c,send:i,loadImage:f},Se}var ke,Je;function ot(){if(Je)return ke;Je=1;const s=Lt(),o=rt(),{log:n}=Ae(),c=Te(),i=nt(),{defaultOptions:f,spawnWorker:y,terminateWorker:b,onMessage:N,loadImage:I,send:q}=Ct();let p=0;return ke=async(v="eng",h=i.LSTM_ONLY,_={},L={})=>{const m=c("Worker",p),{logger:R,errorHandler:k,...g}=s({...f,..._}),E={},M=typeof v=="string"?v.split("+"):v;let Y=h,J=L;const F=[i.DEFAULT,i.LSTM_ONLY].includes(h)&&!g.legacyCore;let $,Q;const V=new Promise((l,d)=>{Q=l,$=d}),ie=l=>{$(l.message)};let B=y(g);B.onerror=ie,p+=1;const P=({id:l,action:d,payload:S})=>new Promise((G,D)=>{n(`[${m}]: Start ${l}, action=${d}`);const U=`${d}-${l}`;E[U]={resolve:G,reject:D},q(B,{workerId:m,jobId:l,action:d,payload:S})}),X=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),x=l=>P(o({id:l,action:"load",payload:{options:{lstmOnly:F,corePath:g.corePath,logging:g.logging}}})),ee=(l,d,S)=>P(o({id:S,action:"FS",payload:{method:"writeFile",args:[l,d]}})),ne=(l,d)=>P(o({id:d,action:"FS",payload:{method:"readFile",args:[l,{encoding:"utf8"}]}})),t=(l,d)=>P(o({id:d,action:"FS",payload:{method:"unlink",args:[l]}})),e=(l,d,S)=>P(o({id:S,action:"FS",payload:{method:l,args:d}})),r=(l,d)=>P(o({id:d,action:"loadLanguage",payload:{langs:l,options:{langPath:g.langPath,dataPath:g.dataPath,cachePath:g.cachePath,cacheMethod:g.cacheMethod,gzip:g.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(Y)&&!g.legacyLang}}})),u=(l,d,S,G)=>P(o({id:G,action:"initialize",payload:{langs:l,oem:d,config:S}})),a=(l="eng",d,S,G)=>{if(F&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(d))throw Error("Legacy model requested but code missing.");const D=d||Y;Y=D;const U=S||J;J=U;const se=(typeof l=="string"?l.split("+"):l).filter(at=>!M.includes(at));return M.push(...se),se.length>0?r(se,G).then(()=>u(l,D,U,G)):u(l,D,U,G)},w=(l={},d)=>P(o({id:d,action:"setParameters",payload:{params:l}})),O=async(l,d={},S={text:!0},G)=>P(o({id:G,action:"recognize",payload:{image:await I(l),options:d,output:S}})),T=async(l,d)=>{if(F)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return P(o({id:d,action:"detect",payload:{image:await I(l)}}))},C=async()=>(B!==null&&(b(B),B=null),Promise.resolve());N(B,({workerId:l,jobId:d,status:S,action:G,data:D})=>{const U=`${G}-${d}`;if(S==="resolve")n(`[${l}]: Complete ${d}`),E[U].resolve({jobId:d,data:D}),delete E[U];else if(S==="reject")if(E[U].reject(D),delete E[U],G==="load"&&$(D),k)k(D);else throw Error(D);else S==="progress"&&R({...D,userJobId:d})});const A={id:m,worker:B,load:X,writeText:ee,readText:ne,removeFile:t,FS:e,reinitialize:a,setParameters:w,recognize:O,detect:T,terminate:C};return x().then(()=>r(v)).then(()=>u(v,h,L)).then(()=>Q(A)).catch(()=>{}),V},ke}var be,Ve;function qt(){if(Ve)return be;Ve=1;const s=ot();return be={recognize:async(c,i,f)=>{const y=await s(i,1,f);return y.recognize(c).finally(async()=>{await y.terminate()})},detect:async(c,i)=>{const f=await s("osd",0,i);return f.detect(c).finally(async()=>{await f.terminate()})}},be}var Ee,Ze;function Nt(){return Ze||(Ze=1,Ee={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Ee}var Re,Qe;function It(){return Qe||(Qe=1,Re={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Re}var Oe,Xe;function Mt(){if(Xe)return Oe;Xe=1,mt();const s=gt(),o=ot(),n=qt(),c=Nt(),i=nt(),f=It(),{setLogging:y}=Ae();return Oe={languages:c,OEM:i,PSM:f,createScheduler:s,createWorker:o,setLogging:y,...n},Oe}var Pt=Mt();const Gt={class:"progress-container"},Dt={class:"img-item"},jt={class:"img-box"},$t=["src"],Bt={class:"file-name"},Ut={class:"ocr-content"},Wt={class:"ocr-text"},Ft={class:"btn"},zt=xe({__name:"card",props:{file:{default:()=>({})}},emits:["delClick"],setup(s,{emit:o}){const n=s,c=o,i=it(()=>{const{workerText:h,status:_}=n.file;return h||(_==="success"?"识别中...":"图片上传中..")}),f=W(!1),y=W(!1),b=W(),N=h=>h.status==="success"?"success":h.status==="fail"?"exception":"",I={name:[te("required","联系人姓名不能为空")],company:[te("required","客户名称不能为空")],phone:[te("required","联系人电话不能为空"),te("phone")],email:[te("email")]},q=W([{prop:"name",label:"姓名"},{prop:"company",label:"公司名称"},{prop:"phone",label:"手机号码"},{prop:"position",label:"职务"},{prop:"email",label:"邮箱"}]),p=()=>{y.value=!0,b.value.onSubmit().then(({data:h})=>{y.value=!1,f.value=!0,st.success(h)}).catch(()=>{y.value=!1})},v=()=>!1;return(h,_)=>{const L=K("el-progress"),m=K("ak-form"),R=K("CircleCheck"),k=K("el-icon"),g=K("el-button");return Z(),oe("div",Gt,[j("div",Dt,[j("div",jt,[z(L,{percentage:h.file.percentage||0,status:N(h.file)},null,8,["percentage","status"]),j("img",{src:h.file.url,alt:""},null,8,$t),j("div",Bt,Ce(h.file.name),1)]),j("div",Ut,[_[1]||(_[1]=j("p",null,"识别结果：",-1)),j("p",null,Ce(i.value),1)]),j("div",Wt,[_[2]||(_[2]=j("p",null,"提取结果",-1)),z(m,{ref_key:"formRef",ref:b,"model-value":h.file.model,"btn-text":!1,rules:I,"label-width":"90",after:v,api:{add:"customerScanCard"},data:q.value},null,8,["model-value","data"])]),j("div",Ft,[f.value?(Z(),et(k,{key:0,size:"26px",color:"green"},{default:H(()=>[z(R)]),_:1})):(Z(),oe(tt,{key:1},[z(g,{type:"danger",onClick:_[0]||(_[0]=E=>c("delClick"))},{default:H(()=>[..._[3]||(_[3]=[ae(" 移除 ",-1)])]),_:1}),z(g,{type:"primary",loading:y.value,onClick:p},{default:H(()=>[..._[4]||(_[4]=[ae(" 一键入库 ",-1)])]),_:1},8,["loading"])],64))])])])}}}),Yt=ut(zt,[["__scopeId","data-v-7c3b904a"]]),Kt={style:{display:"flex"}},Zt=xe({__name:"index",setup(s){const o=W(),n=W([]),c=W(),i=async()=>{c.value=await Pt.createWorker(["eng","chi_sim"],1,{workerPath:"/js/tesseract/worker.min.js",corePath:"/js/tesseract/tesseract-core-simd-lstm.wasm.js"})},f=W(!1),y=p=>{const{file:v,onProgress:h,onSuccess:_,onError:L}=p,m=W();n.value.forEach(g=>{g.uid===v.uid&&(g.status="uploading",m.value=g)});const R=new FormData;R.append("file",v),ht("upload",R,{onUploadProgress:g=>{const E=Math.round(g.loaded*100/g.total);m.value.percentage=E,h({percent:E},v)}}).then(async({data:g})=>{m.value.status="success",m.value.url=g,await b(g,m),_("上传成功",v),qe("fileList",n.value)}).catch(()=>{L("上传失败",v)})},b=async(p,v)=>{const h=await c.value.recognize(p);v.value.workerText=h.data.text,v.value.model=N(h.data.text),await c.value.terminate()},N=p=>{const v=p.match(/姓名[:：]\s*(\S+)/)||p.match(/^([^\d\n]+)\s*[\n\t]/),h=p.match(/职位[:：]\s*(\S+)/)||p.match(/(经理|总监|工程师|设计师)/),_=p.match(/公司[:：]\s*([^\n]+)/),L=p.match(/1[3-9]\d{9}/)||p.match(/\d{3,4}[- ]?\d{7,8}/),m=p.match(/\w+@\w+\.\w+/);return{name:v?v[1].trim():"",position:h?h[1].trim():"",company:_?_[1].trim():"",tel:L?L[0].trim():"",email:m?m[0].trim():""}},I=p=>{n.value.splice(p,1),qe("fileList",n.value)},q=()=>{n.value=[],vt("fileList"),o.value.clearFiles()};return ct(()=>{i(),n.value=lt("fileList")||[]}),(p,v)=>{const h=K("el-button"),_=K("el-upload"),L=dt("loading");return ft((Z(),oe("div",null,[j("div",Kt,[z(_,{ref_key:"uploadRef",ref:o,"file-list":n.value,"onUpdate:fileList":v[0]||(v[0]=m=>n.value=m),"show-file-list":!1,accept:"image/png, image/jpeg, image/jpg","http-request":y,multiple:""},{tip:H(()=>[...v[2]||(v[2]=[j("div",{class:"el-upload__tip"}," 支持jpg,png,jpeg图片格式 ",-1)])]),default:H(()=>[z(h,{type:"primary",icon:"upload-filled"},{default:H(()=>[...v[1]||(v[1]=[ae(" 选择名片 ",-1)])]),_:1})]),_:1},8,["file-list"]),z(h,{type:"danger",onClick:q},{default:H(()=>[...v[3]||(v[3]=[ae(" 清空 ",-1)])]),_:1})]),(Z(!0),oe(tt,null,pt(n.value,(m,R)=>(Z(),et(Yt,{key:R,file:m,onDelClick:k=>I(R)},null,8,["file","onDelClick"]))),128))])),[[L,f.value]])}}});export{Zt as default};
