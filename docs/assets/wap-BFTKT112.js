import{d as A,k as P,E as s,q as U,e as _,g as o,r as u,o as p,h as d,i as r,t as l,x as F,f as z,Z as J,c as M,b as W,F as Z,S as j,J as G,_ as H}from"./index-C2nSLI9N.js";import{_ as K}from"./payFormWap.vue_vue_type_script_setup_true_lang-BjZeyJt0.js";import"./upload.vue_vue_type_script_setup_true_lang-HEsQxvkw.js";import"./validate-B2z5ZXZx.js";const O=["onClick"],Q={class:"ul"},X=A({__name:"wap",setup(Y){const m=P(),n=s(),y=s([]),k={1:"待审核",2:"已确认",3:"未通过"},w=U(()=>m.getSystemDict()),h=m.userInfo?.hasChild,I=(t,a)=>j(t,"{y}-{m}-{d} {h}:{i}"),B=t=>[{text:"审核",key:"check",type:"warning",visible:()=>h&&t.userId!==m.userInfo?.id&&t.status===1},{text:"编辑",key:"edit",type:"primary"},{text:"删除",key:"del",type:"danger"}].filter(a=>typeof a.visible=="function"?a.visible()!==!1:!0),b=s(),x=s(),C=(t,a)=>{if(a==="del")n.value.deleteById(t.id);else{switch(v.value=!1,a){case"check":i.value="审核合同回款";break;case"edit":i.value="修改合同回款";break;default:i.value="查看合同回款";break}n.value.showForm(!0),x.value=t.userId,G(()=>{b.value.getData(t,a)})}},g=s(),N=s([{label:"所属人员",prop:"userId",render:"picker",visible:()=>h,field:{clearable:!0},picker:{ajax:{api:"userChildList",data:{}},columnsFieldNames:{text:"userName",value:"id"}}},{prop:"code",label:"回款编号"},{label:"客户名称",prop:"customerId",field:{clearable:!0},render:"picker",picker:{remote:!0,openLoad:!0,keyword:"company",ajax:{api:"customerList",data:{userId:g}},columnsFieldNames:{text:"company",value:"id"}}},{prop:"status",label:"审核状态",render:"picker",options:{1:"待审核",2:"通过",3:"拒绝"}}]),D=(t,a,f)=>{t==="userId"&&(f.customerId=""),g.value=a},v=s(!0),i=s("新增合同回款"),V=t=>{t==="add"&&(v.value=!0)},E=t=>t,L=t=>{switch(t){case"cancel":n.value.showForm();break;case"submit":n.value.onRefresh(),n.value.showForm();break}};return(t,a)=>{const f=u("van-tag"),S=u("van-collapse-item"),R=u("van-button"),T=u("van-swipe-cell"),$=u("w-list"),q=u("van-collapse");return p(),_(q,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e)},{default:o(()=>[d($,{ref_key:"listRef",ref:n,api:{get:"contractPaymentList",del:"contractPaymentDel"},"search-form-data":N.value,"add-icon-visible":!0,"form-title":i.value,before:E,onSearchFormChange:D,onNavBarEvent:V},{item:o(({data:e})=>[d(T,null,{right:o(()=>[(p(!0),M(Z,null,W(B(e),c=>(p(),_(R,{key:c.key,square:"",color:c.color,type:c.type,text:c.text,size:"small",onClick:ee=>C(e,c.key)},null,8,["color","type","text","onClick"]))),128))]),default:o(()=>[d(S,{name:e.id,value:e.code},{title:o(()=>[r("div",{onClick:J(c=>C(e),["stop"])},[F(l(e.customerName)+" ",1),e.status?(p(),_(f,{key:0,type:e.status===1?"danger":e.status===2?"success":"primary"},{default:o(()=>[F(l(k[e.status]),1)]),_:2},1032,["type"])):z("",!0)],8,O)]),default:o(()=>[r("ul",Q,[r("li",null,"合同名称："+l(e.contractName),1),r("li",null,"合同编号："+l(e.contractCode),1),r("li",null,"回款金额："+l(e.money),1),r("li",null,"回款账户："+l(w.value.accountType[e.account]),1),r("li",null,"创建时间："+l(I(e.creatDate)),1),r("li",null,"审核状态："+l(k[e.status]),1)])]),_:2},1032,["name","value"])]),_:2},1024)]),default:o(()=>[d(K,{ref_key:"payFormRef",ref:b,"is-add":v.value,"current-user-id":x.value,onClickEvent:L},null,8,["is-add","current-user-id"])]),_:1},8,["search-form-data","form-title"])]),_:1},8,["modelValue"])}}}),re=H(X,[["__scopeId","data-v-29d6e2b9"]]);export{re as default};
