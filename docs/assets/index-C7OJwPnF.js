import{d as xe,q as it,E as F,r as K,c as oe,o as Z,i as j,h as z,t as Ce,e as et,g as H,F as tt,x as ae,T as st,_ as ct,m as ut,W as lt,w as ft,a as dt,b as pt,R as ht,X as qe,Y as vt}from"./index-DuawtOAE.js";import{v as te}from"./validate-DWWidr2n.js";var ce={exports:{}},Ne;function mt(){return Ne||(Ne=1,(function(i){var o=(function(n){var u=Object.prototype,s=u.hasOwnProperty,f=Object.defineProperty||function(t,e,r){t[e]=r.value},g,b=typeof Symbol=="function"?Symbol:{},N=b.iterator||"@@iterator",I=b.asyncIterator||"@@asyncIterator",q=b.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch{p=function(e,r,c){return e[r]=c}}function h(t,e,r,c){var a=e&&e.prototype instanceof m?e:m,y=Object.create(a.prototype),O=new x(c||[]);return f(y,"_invoke",{value:ie(t,r,O)}),y}n.wrap=h;function L(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(c){return{type:"throw",arg:c}}}var S="suspendedStart",w="suspendedYield",v="executing",R="completed",k={};function m(){}function E(){}function M(){}var Y={};p(Y,N,function(){return this});var J=Object.getPrototypeOf,$=J&&J(J(ee([])));$&&$!==u&&s.call($,N)&&(Y=$);var U=M.prototype=m.prototype=Object.create(Y);E.prototype=M,f(U,"constructor",{value:M,configurable:!0}),f(M,"constructor",{value:E,configurable:!0}),E.displayName=p(M,q,"GeneratorFunction");function Q(t){["next","throw","return"].forEach(function(e){p(t,e,function(r){return this._invoke(e,r)})})}n.isGeneratorFunction=function(t){var e=typeof t=="function"&&t.constructor;return e?e===E||(e.displayName||e.name)==="GeneratorFunction":!1},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,p(t,q,"GeneratorFunction")),t.prototype=Object.create(U),t},n.awrap=function(t){return{__await:t}};function V(t,e){function r(y,O,T,C){var A=L(t[y],t,O);if(A.type==="throw")C(A.arg);else{var l=A.arg,d=l.value;return d&&typeof d=="object"&&s.call(d,"__await")?e.resolve(d.__await).then(function(_){r("next",_,T,C)},function(_){r("throw",_,T,C)}):e.resolve(d).then(function(_){l.value=_,T(l)},function(_){return r("throw",_,T,C)})}}var c;function a(y,O){function T(){return new e(function(C,A){r(y,O,C,A)})}return c=c?c.then(T,T):T()}f(this,"_invoke",{value:a})}Q(V.prototype),p(V.prototype,I,function(){return this}),n.AsyncIterator=V,n.async=function(t,e,r,c,a){a===void 0&&(a=Promise);var y=new V(h(t,e,r,c),a);return n.isGeneratorFunction(e)?y:y.next().then(function(O){return O.done?O.value:y.next()})};function ie(t,e,r){var c=S;return function(y,O){if(c===v)throw new Error("Generator is already running");if(c===R){if(y==="throw")throw O;return ne()}for(r.method=y,r.arg=O;;){var T=r.delegate;if(T){var C=W(T,r);if(C){if(C===k)continue;return C}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(c===S)throw c=R,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);c=v;var A=L(t,e,r);if(A.type==="normal"){if(c=r.done?R:w,A.arg===k)continue;return{value:A.arg,done:r.done}}else A.type==="throw"&&(c=R,r.method="throw",r.arg=A.arg)}}}function W(t,e){var r=e.method,c=t.iterator[r];if(c===g)return e.delegate=null,r==="throw"&&t.iterator.return&&(e.method="return",e.arg=g,W(t,e),e.method==="throw")||r!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),k;var a=L(c,t.iterator,e.arg);if(a.type==="throw")return e.method="throw",e.arg=a.arg,e.delegate=null,k;var y=a.arg;if(!y)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,k;if(y.done)e[t.resultName]=y.value,e.next=t.nextLoc,e.method!=="return"&&(e.method="next",e.arg=g);else return y;return e.delegate=null,k}Q(U),p(U,q,"Generator"),p(U,N,function(){return this}),p(U,"toString",function(){return"[object Generator]"});function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function X(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}n.keys=function(t){var e=Object(t),r=[];for(var c in e)r.push(c);return r.reverse(),function a(){for(;r.length;){var y=r.pop();if(y in e)return a.value=y,a.done=!1,a}return a.done=!0,a}};function ee(t){if(t){var e=t[N];if(e)return e.call(t);if(typeof t.next=="function")return t;if(!isNaN(t.length)){var r=-1,c=function a(){for(;++r<t.length;)if(s.call(t,r))return a.value=t[r],a.done=!1,a;return a.value=g,a.done=!0,a};return c.next=c}}return{next:ne}}n.values=ee;function ne(){return{value:g,done:!0}}return x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(X),!t)for(var e in this)e.charAt(0)==="t"&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(C,A){return y.type="throw",y.arg=t,e.next=C,A&&(e.method="next",e.arg=g),!!A}for(var c=this.tryEntries.length-1;c>=0;--c){var a=this.tryEntries[c],y=a.completion;if(a.tryLoc==="root")return r("end");if(a.tryLoc<=this.prev){var O=s.call(a,"catchLoc"),T=s.call(a,"finallyLoc");if(O&&T){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(O){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else if(T){if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r];if(c.tryLoc<=this.prev&&s.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var a=c;break}}a&&(t==="break"||t==="continue")&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var y=a?a.completion:{};return y.type=t,y.arg=e,a?(this.method="next",this.next=a.finallyLoc,k):this.complete(y)},complete:function(t,e){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&e&&(this.next=e),k},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),X(r),k}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var c=r.completion;if(c.type==="throw"){var a=c.arg;X(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:ee(t),resultName:e,nextLoc:r},this.method==="next"&&(this.arg=g),k}},n})(i.exports);try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}})(ce)),ce.exports}var ue,Ie;function Te(){return Ie||(Ie=1,ue=(i,o)=>`${i}-${o}-${Math.random().toString(16).slice(3,8)}`),ue}var le,Me;function rt(){if(Me)return le;Me=1;const i=Te();let o=0;return le=({id:n,action:u,payload:s={}})=>{let f=n;return typeof f>"u"&&(f=i("Job",o),o+=1),{id:f,action:u,payload:s}},le}var re={},Pe;function Ae(){if(Pe)return re;Pe=1;let i=!1;return re.logging=i,re.setLogging=o=>{i=o},re.log=(...o)=>i?console.log.apply(this,o):null,re}var fe,Ge;function gt(){if(Ge)return fe;Ge=1;const i=rt(),{log:o}=Ae(),n=Te();let u=0;return fe=()=>{const s=n("Scheduler",u),f={},g={};let b=[];u+=1;const N=()=>b.length,I=()=>Object.keys(f).length,q=()=>{if(b.length!==0){const w=Object.keys(f);for(let v=0;v<w.length;v+=1)if(typeof g[w[v]]>"u"){b[0](f[w[v]]);break}}},p=(w,v)=>new Promise((R,k)=>{const m=i({action:w,payload:v});b.push(async E=>{b.shift(),g[E.id]=m;try{R(await E[w].apply(this,[...v,m.id]))}catch(M){k(M)}finally{delete g[E.id],q()}}),o(`[${s}]: Add ${m.id} to JobQueue`),o(`[${s}]: JobQueue length=${b.length}`),q()});return{addWorker:w=>(f[w.id]=w,o(`[${s}]: Add ${w.id}`),o(`[${s}]: Number of workers=${I()}`),q(),w.id),addJob:async(w,...v)=>{if(I()===0)throw Error(`[${s}]: You need to have at least one worker before adding jobs`);return p(w,v)},terminate:async()=>{Object.keys(f).forEach(async w=>{await f[w].terminate()}),b=[]},getQueueLen:N,getNumWorkers:I}},fe}function yt(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var de,De;function wt(){return De||(De=1,de=i=>{const o={};return typeof WorkerGlobalScope<"u"?o.type="webworker":typeof document=="object"?o.type="browser":typeof process=="object"&&typeof yt=="function"&&(o.type="node"),typeof i>"u"?o:o[i]}),de}var pe,je;function Lt(){if(je)return pe;je=1;const o=wt()("type")==="browser"?n=>new URL(n,window.location.href).href:n=>n;return pe=n=>{const u={...n};return["corePath","workerPath","langPath"].forEach(s=>{n[s]&&(u[s]=o(u[s]))}),u},pe}var he,Ue;function nt(){return Ue||(Ue=1,he={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),he}const St="6.0.1",_t={version:St};var ve,We;function kt(){return We||(We=1,ve={workerBlobURL:!0,logger:()=>{}}),ve}var me,Be;function bt(){if(Be)return me;Be=1;const i=_t.version;return me={...kt(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${i}/dist/worker.min.js`},me}var ge,Fe;function Et(){return Fe||(Fe=1,ge=({workerPath:i,workerBlobURL:o})=>{let n;if(Blob&&URL&&o){const u=new Blob([`importScripts("${i}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(u))}else n=new Worker(i);return n}),ge}var ye,$e;function Rt(){return $e||($e=1,ye=i=>{i.terminate()}),ye}var we,ze;function Ot(){return ze||(ze=1,we=(i,o)=>{i.onmessage=({data:n})=>{o(n)}}),we}var Le,Ye;function Tt(){return Ye||(Ye=1,Le=async(i,o)=>{i.postMessage(o)}),Le}var Se,Ke;function At(){if(Ke)return Se;Ke=1;const i=n=>new Promise((u,s)=>{const f=new FileReader;f.onload=()=>{u(f.result)},f.onerror=({target:{error:{code:g}}})=>{s(Error(`File could not be read! Code=${g}`))},f.readAsArrayBuffer(n)}),o=async n=>{let u=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?u=atob(n.split(",")[1]).split("").map(s=>s.charCodeAt(0)):u=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(u=await o(n.src)),n.tagName==="VIDEO"&&(u=await o(n.poster)),n.tagName==="CANVAS"&&await new Promise(s=>{n.toBlob(async f=>{u=await i(f),s()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const s=await n.convertToBlob();u=await i(s)}else(n instanceof File||n instanceof Blob)&&(u=await i(n));return new Uint8Array(u)};return Se=o,Se}var _e,He;function Ct(){if(He)return _e;He=1;const i=bt(),o=Et(),n=Rt(),u=Ot(),s=Tt(),f=At();return _e={defaultOptions:i,spawnWorker:o,terminateWorker:n,onMessage:u,send:s,loadImage:f},_e}var ke,Je;function ot(){if(Je)return ke;Je=1;const i=Lt(),o=rt(),{log:n}=Ae(),u=Te(),s=nt(),{defaultOptions:f,spawnWorker:g,terminateWorker:b,onMessage:N,loadImage:I,send:q}=Ct();let p=0;return ke=async(h="eng",L=s.LSTM_ONLY,S={},w={})=>{const v=u("Worker",p),{logger:R,errorHandler:k,...m}=i({...f,...S}),E={},M=typeof h=="string"?h.split("+"):h;let Y=L,J=w;const $=[s.DEFAULT,s.LSTM_ONLY].includes(L)&&!m.legacyCore;let U,Q;const V=new Promise((l,d)=>{Q=l,U=d}),ie=l=>{U(l.message)};let W=g(m);W.onerror=ie,p+=1;const P=({id:l,action:d,payload:_})=>new Promise((G,D)=>{n(`[${v}]: Start ${l}, action=${d}`);const B=`${d}-${l}`;E[B]={resolve:G,reject:D},q(W,{workerId:v,jobId:l,action:d,payload:_})}),X=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),x=l=>P(o({id:l,action:"load",payload:{options:{lstmOnly:$,corePath:m.corePath,logging:m.logging}}})),ee=(l,d,_)=>P(o({id:_,action:"FS",payload:{method:"writeFile",args:[l,d]}})),ne=(l,d)=>P(o({id:d,action:"FS",payload:{method:"readFile",args:[l,{encoding:"utf8"}]}})),t=(l,d)=>P(o({id:d,action:"FS",payload:{method:"unlink",args:[l]}})),e=(l,d,_)=>P(o({id:_,action:"FS",payload:{method:l,args:d}})),r=(l,d)=>P(o({id:d,action:"loadLanguage",payload:{langs:l,options:{langPath:m.langPath,dataPath:m.dataPath,cachePath:m.cachePath,cacheMethod:m.cacheMethod,gzip:m.gzip,lstmOnly:[s.DEFAULT,s.LSTM_ONLY].includes(Y)&&!m.legacyLang}}})),c=(l,d,_,G)=>P(o({id:G,action:"initialize",payload:{langs:l,oem:d,config:_}})),a=(l="eng",d,_,G)=>{if($&&[s.TESSERACT_ONLY,s.TESSERACT_LSTM_COMBINED].includes(d))throw Error("Legacy model requested but code missing.");const D=d||Y;Y=D;const B=_||J;J=B;const se=(typeof l=="string"?l.split("+"):l).filter(at=>!M.includes(at));return M.push(...se),se.length>0?r(se,G).then(()=>c(l,D,B,G)):c(l,D,B,G)},y=(l={},d)=>P(o({id:d,action:"setParameters",payload:{params:l}})),O=async(l,d={},_={text:!0},G)=>P(o({id:G,action:"recognize",payload:{image:await I(l),options:d,output:_}})),T=async(l,d)=>{if($)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return P(o({id:d,action:"detect",payload:{image:await I(l)}}))},C=async()=>(W!==null&&(b(W),W=null),Promise.resolve());N(W,({workerId:l,jobId:d,status:_,action:G,data:D})=>{const B=`${G}-${d}`;if(_==="resolve")n(`[${l}]: Complete ${d}`),E[B].resolve({jobId:d,data:D}),delete E[B];else if(_==="reject")if(E[B].reject(D),delete E[B],G==="load"&&U(D),k)k(D);else throw Error(D);else _==="progress"&&R({...D,userJobId:d})});const A={id:v,worker:W,load:X,writeText:ee,readText:ne,removeFile:t,FS:e,reinitialize:a,setParameters:y,recognize:O,detect:T,terminate:C};return x().then(()=>r(h)).then(()=>c(h,L,w)).then(()=>Q(A)).catch(()=>{}),V},ke}var be,Ve;function qt(){if(Ve)return be;Ve=1;const i=ot();return be={recognize:async(u,s,f)=>{const g=await i(s,1,f);return g.recognize(u).finally(async()=>{await g.terminate()})},detect:async(u,s)=>{const f=await i("osd",0,s);return f.detect(u).finally(async()=>{await f.terminate()})}},be}var Ee,Ze;function Nt(){return Ze||(Ze=1,Ee={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Ee}var Re,Qe;function It(){return Qe||(Qe=1,Re={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Re}var Oe,Xe;function Mt(){if(Xe)return Oe;Xe=1,mt();const i=gt(),o=ot(),n=qt(),u=Nt(),s=nt(),f=It(),{setLogging:g}=Ae();return Oe={languages:u,OEM:s,PSM:f,createScheduler:i,createWorker:o,setLogging:g,...n},Oe}var Pt=Mt();const Gt={class:"progress-container"},Dt={class:"img-item"},jt={class:"img-box"},Ut=["src"],Wt={class:"file-name"},Bt={class:"ocr-content"},Ft={class:"ocr-text"},$t={class:"btn"},zt=xe({__name:"card",props:{file:{default:()=>({})}},emits:["delClick"],setup(i,{emit:o}){const n=i,u=o,s=it(()=>{const{workerText:L,status:S}=n.file;return L||(S==="success"?"识别中...":"图片上传中..")}),f=F(!1),g=F(!1),b=F(),N=L=>L.status==="success"?"success":L.status==="fail"?"exception":"",I={name:[te("required","联系人姓名不能为空")],company:[te("required","客户名称不能为空")],phone:[te("required","联系人电话不能为空"),te("phone")],email:[te("email")]},q=F([{prop:"name",label:"姓名"},{prop:"company",label:"公司名称"},{prop:"phone",label:"手机号码"},{prop:"position",label:"职务"},{prop:"email",label:"邮箱"}]),p=()=>{g.value=!0,b.value.onSubmit().then(({data:L})=>{g.value=!1,f.value=!0,st.success(L)}).catch(()=>{g.value=!1})},h=()=>!1;return(L,S)=>{const w=K("el-progress"),v=K("ak-form"),R=K("CircleCheck"),k=K("el-icon"),m=K("el-button");return Z(),oe("div",Gt,[j("div",Dt,[j("div",jt,[z(w,{percentage:i.file.percentage||0,status:N(i.file)},null,8,["percentage","status"]),j("img",{src:i.file.url,alt:""},null,8,Ut),j("div",Wt,Ce(i.file.name),1)]),j("div",Bt,[S[1]||(S[1]=j("p",null,"识别结果：",-1)),j("p",null,Ce(s.value),1)]),j("div",Ft,[S[2]||(S[2]=j("p",null,"提取结果",-1)),z(v,{ref_key:"formRef",ref:b,"model-value":i.file.model,"btn-text":!1,rules:I,"label-width":"90",after:h,api:{add:"customerScanCard"},data:q.value},null,8,["model-value","data"])]),j("div",$t,[f.value?(Z(),et(k,{key:0,size:"26px",color:"green"},{default:H(()=>[z(R)]),_:1})):(Z(),oe(tt,{key:1},[z(m,{type:"danger",onClick:S[0]||(S[0]=E=>u("delClick"))},{default:H(()=>[...S[3]||(S[3]=[ae(" 移除 ",-1)])]),_:1}),z(m,{type:"primary",loading:g.value,onClick:p},{default:H(()=>[...S[4]||(S[4]=[ae(" 一键入库 ",-1)])]),_:1},8,["loading"])],64))])])])}}}),Yt=ct(zt,[["__scopeId","data-v-d8aafabf"]]),Kt={style:{display:"flex"}},Zt=xe({__name:"index",setup(i){const o=F(),n=F([]),u=F(),s=async()=>{u.value=await Pt.createWorker(["eng","chi_sim"],1,{workerPath:"/js/tesseract/worker.min.js",corePath:"/js/tesseract/tesseract-core-simd-lstm.wasm.js"})},f=F(!1),g=p=>{const{file:h,onProgress:L,onSuccess:S,onError:w}=p,v=F();n.value.forEach(m=>{m.uid===h.uid&&(m.status="uploading",v.value=m)});const R=new FormData;R.append("file",h),ht("upload",R,{onUploadProgress:m=>{const E=Math.round(m.loaded*100/m.total);v.value.percentage=E,L({percent:E},h)}}).then(async({data:m})=>{v.value.status="success",v.value.url=m,await b(m,v),S("上传成功",h),qe("fileList",n.value)}).catch(()=>{w("上传失败",h)})},b=async(p,h)=>{const L=await u.value.recognize(p);h.value.workerText=L.data.text,h.value.model=N(L.data.text),await u.value.terminate()},N=p=>{const h=p.match(/姓名[:：]\s*(\S+)/)||p.match(/^([^\d\n]+)\s*[\n\t]/),L=p.match(/职位[:：]\s*(\S+)/)||p.match(/(经理|总监|工程师|设计师)/),S=p.match(/公司[:：]\s*([^\n]+)/),w=p.match(/1[3-9]\d{9}/)||p.match(/\d{3,4}[- ]?\d{7,8}/),v=p.match(/\w+@\w+\.\w+/);return{name:h?h[1].trim():"",position:L?L[1].trim():"",company:S?S[1].trim():"",tel:w?w[0].trim():"",email:v?v[0].trim():""}},I=p=>{n.value.splice(p,1),qe("fileList",n.value)},q=()=>{n.value=[],vt("fileList"),o.value.clearFiles()};return ut(()=>{s(),n.value=lt("fileList")||[]}),(p,h)=>{const L=K("el-button"),S=K("el-upload"),w=dt("loading");return ft((Z(),oe("div",null,[j("div",Kt,[z(S,{ref_key:"uploadRef",ref:o,"file-list":n.value,"onUpdate:fileList":h[0]||(h[0]=v=>n.value=v),"show-file-list":!1,accept:"image/png, image/jpeg, image/jpg","http-request":g,multiple:""},{tip:H(()=>[...h[2]||(h[2]=[j("div",{class:"el-upload__tip"}," 支持jpg,png,jpeg图片格式 ",-1)])]),default:H(()=>[z(L,{type:"primary",icon:"upload-filled"},{default:H(()=>[...h[1]||(h[1]=[ae(" 选择名片 ",-1)])]),_:1})]),_:1},8,["file-list"]),z(L,{type:"danger",onClick:q},{default:H(()=>[...h[3]||(h[3]=[ae(" 清空 ",-1)])]),_:1})]),(Z(!0),oe(tt,null,pt(n.value,(v,R)=>(Z(),et(Yt,{key:R,file:v,onDelClick:k=>I(R)},null,8,["file","onDelClick"]))),128))])),[[w,f.value]])}}});export{Zt as default};
