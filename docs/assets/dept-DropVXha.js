import{d as L,r as l,I as E,e as V,o as D,g as u,a as p,w as S,F as x,D as b,B as z}from"./index-BiMixNdo.js";import{_ as B}from"./index.vue_vue_type_style_index_0_lang-D9ICdJzx.js";const q=L({__name:"dept",setup(w){const m=l(),h=l([{prop:"name",label:"部门名称"},{prop:"userName",label:"负责人",search:!1},{prop:"status",label:"状态",render:"tag",replaceValue:"status",custom:{1:"success",0:"danger"},search:{render:"select",options:"status"}},{label:"操作",render:"buttons",buttons:[{key:"add",label:"新增",icon:"plus",click:e=>{i(!0,e)}},{key:"edit",label:"编辑",click:e=>{i(!1,e)}},{label:"删除",key:"del",tooltip:"del",popConfirm:{confirmButtonType:"danger"},disabled:e=>e.hasChildren===1}]}]),k=(e,t,o)=>{b("deptList",{tid:e.id}).then(a=>{o(a.data?.list||[])})},_=(e,t)=>(e==="get"&&!t.tid&&(t.tid=0),t),v=l(),r=l(!1),d=l("新增部门"),s=l({status:1}),i=(e,t)=>{r.value=!0,e?(s.value.tid=t?.id||"",d.value="新增部门"):(t?.tid===0&&(t.tid=""),z(()=>{s.value=t||{}}),d.value="修改部门")},f=()=>{r.value=!1},g=()=>{f(),m.value.getData()},y=e=>(e?.tid&&(e.tid=0),e),C=l([{prop:"tid",label:"上级部门",render:"tree-select",attr:{placeholder:"请选择上级部门(不选则为顶级)",load:(e,t)=>{b("deptList",{tid:e.data.id||0}).then(o=>{const a=o.data?.list||[];a.forEach(n=>{n.hasChildren=!n.hasChildren}),t(a)})},lazy:!0,checkStrictly:!0,props:{children:"children",label:"name",value:"id",isLeaf:"hasChildren"}}},{label:"部门名称",prop:"name",formItem:{rules:[{required:!0,message:"请输入部门名称",trigger:"blur"}]}},{label:"负责人",prop:"userId",render:"component",component:E(B)},{label:"状态",prop:"status",render:"radio",options:"status"}]);return(e,t)=>{const o=p("ak-list"),a=p("ak-form"),n=p("el-dialog");return D(),V(x,null,[u(o,{ref_key:"tableListEl",ref:m,pk:"id",columns:h.value,api:{list:"deptList",del:"deptDel"},"control-btn":[{key:"add",click:()=>{i(!0)}}],before:_,"table-prop":{rowKey:"id",load:k,lazy:!0,treeProps:{children:"children",hasChildren:"hasChildren"}}},null,8,["columns","control-btn","table-prop"]),u(n,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=c=>r.value=c),width:"500",title:d.value,class:"form-dialog"},{default:S(()=>[u(a,{ref_key:"formEl",ref:v,modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=c=>s.value=c),"label-width":"100px",pk:"id",before:y,after:g,data:C.value,api:{add:"deptSave",edit:"deptEdit",detail:"deptGet"},onCancel:f},null,8,["modelValue","data"])]),_:1},8,["modelValue","title"])],64)}}});export{q as default};
