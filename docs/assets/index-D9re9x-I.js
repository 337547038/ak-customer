import{d as q,k as I,v as l,m as R,c as B,i as u,h as a,g as m,B as p,j as N,u as S,r as c,D as A,z as D,C as M,o as T,s as U,_ as W,O as x}from"./index-D65I1yai.js";import{W as j}from"./index-Do97sbjq.js";const z={class:"container"},E={class:"form"},G=["src"],K={class:"weixin",style:{padding:"10px 0"}},h=q({__name:"index",setup(O){const f=S(),r=N(),y=I(),_=l(),b=()=>{_.value.open()},g=(t,e)=>{e?(A("resources",!0),y.setLoginInfo(t,!0),k(t.roleId).then(()=>{const o=r.query.redirect?r.query.redirect:"/";D(()=>{f.push({path:o})})})):n()},k=t=>new Promise(e=>{if(!t)return e();p("roleGetByIds",{id:t}).then(o=>{const d=o.data;M("resources",d,0),e()})}),s=l({userName:"admin",password:"123456"}),w=l([{prop:"userName",label:"用户名",formItem:{rules:[{required:!0,message:"请输入用户名",trigger:"blur"}]},attr:{}},{prop:"password",label:"密码",formItem:{rules:[{required:!0,message:"请输入密码",trigger:"blur"}]},attr:{type:"password"}}]),v=l(),n=()=>{p("getCaptcha",{}).then(t=>{const{base64:e,codeId:o}=t.data;v.value="data:image/png;base64,"+e,s.value.codeId=o}).catch(()=>{})},C=()=>{const t=r.query.code,e=r.query.state;t&&e&&p("scanLogin",{code:t}).then(o=>{g(o.data,!0)}).catch(()=>{f.push({path:"/login",query:{redirect:"/system/usercenter"}}),n()})};return R(()=>{n(),C()}),(t,e)=>{const o=c("el-input"),d=c("el-form-item"),L=c("ak-form"),V=c("el-button");return T(),B("div",z,[u("div",E,[e[3]||(e[3]=u("h3",null,"AK客户管理系统",-1)),a(L,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=i=>s.value=i),"label-width":"100",data:w.value,api:{add:"userLogin"},after:g},{default:m(()=>[a(d,{label:"验证码",class:"item-code"},{default:m(()=>[a(o,{modelValue:s.value.code,"onUpdate:modelValue":e[0]||(e[0]=i=>s.value.code=i),placeholder:"输入验证码"},null,8,["modelValue"]),u("img",{src:v.value,class:"img",alt:"获取验证码",onClick:n},null,8,G)]),_:1})]),_:1},8,["modelValue","data"]),u("div",K,[a(V,{type:"primary",text:"",onClick:b},{default:m(()=>[...e[2]||(e[2]=[U(" 微信扫码登录 ",-1)])]),_:1})]),a(j,{ref_key:"wxLoginRef",ref:_},null,512)])])}}});typeof x=="function"&&x(h);const H=W(h,[["__scopeId","data-v-9575a2b3"]]);export{H as default};
