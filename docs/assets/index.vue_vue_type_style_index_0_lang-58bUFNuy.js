import{d as $,R as w,l as G,r as s,q as W,z as F,N as H,e as h,o as m,j as C,g as a,a as d,w as u,h as v,b as g,c as J,D as E,E as K,B as O}from"./index-BsPutIDd.js";const P={key:0,style:{display:"flex","align-items":"center"}},Q={class:"expand-user-dialog"},X={class:"sidebar-tree"},Y={class:"table-list"},Z={key:0,style:{display:"flex","justify-content":"center"}},le=$({__name:"index",props:w({showInput:{type:Boolean,default:!0},placeholder:{default:""},modelValue:{default:""},multiple:{type:Boolean,default:!1},selectAll:{type:Boolean,default:!0}},{modelValue:{},modelModifiers:{}}),emits:w(["selectClick"],["update:modelValue"]),setup(_,{expose:L,emit:I}){const V=_,f=I,r=G(_,"modelValue"),t=s(""),n=s(!1),N=()=>{n.value=!0},R=W(()=>V.modelValue,()=>{t.value="",r.value&&!t.value&&E("userGet",{id:r.value}).then(l=>{t.value=l.data.userName})}),M=()=>{r.value="",t.value=""},k=s(),S=l=>{k.value=l.id,c.value.getData()},U=(l,e)=>{E("deptList",{tid:l.data.id||0}).then(y=>{const o=y.data.list;o.forEach(p=>{p.hasChildren=!p.hasChildren}),e(o||[])})},c=s(),j=(l,e)=>(k.value&&(e.departmentId=k.value,e.status=1),e),q=F(()=>V.multiple),z=s([{prop:"selection",type:"selection",visible:q},{prop:"userName",label:"用户名称"},{label:"操作",render:"buttons",buttons:[{attr:{type:"primary",text:!0},key:"select",label:"选择",click:l=>{t.value=l.userName,r.value=l.id,n.value=!1,f("selectClick",[l])}}]}]),x=s([]),B=l=>{if(l==="all")return f("selectClick",l),b(),!1;const e=c.value.getSelectionRows();e.length>0?(f("selectClick",e),b()):K.error("请选择勾选用户")},b=()=>{n.value=!1,O(()=>{c.value.table?.clearSelection()})},A=l=>{x.value=l};return H(()=>{R()}),L({open:N}),(l,e)=>{const y=d("el-input"),o=d("el-button"),p=d("el-tree"),D=d("ak-list"),T=d("el-dialog");return m(),h("div",null,[l.showInput?(m(),h("div",P,[a(y,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i),readonly:"",placeholder:l.placeholder,clearable:!0,onClick:e[1]||(e[1]=i=>N())},null,8,["modelValue","placeholder"]),a(o,{text:"",type:"primary",onClick:M},{default:u(()=>[...e[4]||(e[4]=[v(" 清空 ",-1)])]),_:1})])):C("",!0),a(T,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value=i),title:"用户选择","append-to-body":!0,width:"800px"},{default:u(()=>[g("div",Q,[g("div",X,[a(p,{ref:"treeEl","node-key":"id",props:{label:"name",value:"id",children:"children",isLeaf:"hasChildren"},"highlight-current":"",load:U,lazy:"",onNodeClick:S},null,512)]),g("div",Y,[a(D,{ref_key:"tableListEl",ref:c,pk:"id","search-icon-visible":!1,"columns-icon-visible":!1,before:j,columns:z.value,api:{list:"userList"},onSelectionChange:A},null,8,["columns"]),l.multiple?(m(),h("div",Z,[l.selectAll?(m(),J(o,{key:0,type:"danger",onClick:e[2]||(e[2]=i=>B("all"))},{default:u(()=>[...e[5]||(e[5]=[v(" 选择全部 ",-1)])]),_:1})):C("",!0),a(o,{type:"primary",disabled:!x.value.length,onClick:B},{default:u(()=>[...e[6]||(e[6]=[v(" 确定 ",-1)])]),_:1},8,["disabled"]),a(o,{onClick:b},{default:u(()=>[...e[7]||(e[7]=[v(" 取消 ",-1)])]),_:1})])):C("",!0)])])]),_:1},8,["modelValue"])])}}});export{le as _};
