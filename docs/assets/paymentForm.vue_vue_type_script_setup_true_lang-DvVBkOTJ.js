import{v as l}from"./validate-BQpdx7O0.js";import{d as P,l as a,s as I,e as _,g as U,z as F,r as i,o as k,f as B,h as H}from"./index-Br-qEitB.js";const S=P({__name:"paymentForm",props:{userId:{}},emits:["callback"],setup(y,{expose:g,emit:x}){const f=y,C=x,s=a(!1),n=a(""),p=I(()=>!f.userId&&r.value.status===2),c=a(),r=a({}),u=a(!1),d=()=>{s.value=!1,r.value={},c.value.resetFields()},v=a(),D=I(()=>v.value||f.userId),b=a(!1),V=a([{prop:"code",label:"回款编号",formItem:{rules:[l("required","回款编号不能为空","change")]}},{prop:"contractId",label:"合同",render:"select",formItem:{rules:[l("required","请选择所属合同","change")]},ajax:{api:"contractList",data:{userId:D},label:"name",value:"id"},attr:{disabled:u,clearable:!0}},{prop:"money",label:"回款金额",formItem:{rules:[l("required","回款金额不能为空","change"),l("money")]}},{prop:"account",label:"回款账号",render:"select",options:"accountType",formItem:{rules:[l("required","请选择回款账号","change")]}},{prop:"datetime",label:"回款时间",render:"datePicker",attr:{valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD"},formItem:{rules:[l("required","请输入回款时间","change")]}},{label:"审核",prop:"status",render:"select",options:[{value:1,label:"待审核"},{value:2,label:"通过"},{value:3,label:"拒绝"}],visible:b},{prop:"remark",label:"备注",attr:{style:{width:"100%"},type:"textarea",rows:5}}]),Y=(o,e,t)=>{s.value=!0,n.value=o?"修改合同回款":"新增合同回款",t&&(n.value="审批/查看回款详情"),v.value=e?.userId,b.value=!!t,o&&e&&F(()=>{c.value.getData({id:e.id})}),u.value=!1,!o&&e&&(r.value.contractId=e.id,u.value=!0)},h=(o,e,t)=>{["add","update"].includes(t)&&(d(),C("callback"))};return g({open:Y}),(o,e)=>{const t=i("el-alert"),q=i("ak-form"),M=i("el-dialog");return k(),_(M,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value=m),width:"800",title:n.value,class:"form-dialog","destroy-on-close":"","before-close":d},{default:U(()=>[p.value?(k(),_(t,{key:0,title:"审核通过，不能修改数据",type:"success"})):B("",!0),H(q,{disabled:p.value,pk:"id",ref_key:"formRef",ref:c,data:V.value,"label-width":"110",class:"flex-form flex-form-2",after:h,api:{detail:"contractPaymentGet",add:"contractPaymentSave",edit:"contractPaymentEdit"},onCancel:d,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=m=>r.value=m)},null,8,["disabled","data","modelValue"])]),_:1},8,["modelValue","title"])}}});export{S as _};
