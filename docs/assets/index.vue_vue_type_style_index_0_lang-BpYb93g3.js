import{d as q,A as E,B as G,l as s,m as W,s as F,N as H,c as h,f as C,h as o,r as d,g as u,o as v,v as f,i as g,e as J,D as I,E as K,z as O}from"./index-CyV0dc7F.js";const P={key:0,style:{display:"flex","align-items":"center"}},Q={class:"expand-user-dialog"},X={class:"sidebar-tree"},Y={class:"table-list"},Z={key:0,style:{display:"flex","justify-content":"center"}},le=q({__name:"index",props:E({showInput:{type:Boolean,default:!0},placeholder:{},modelValue:{},multiple:{type:Boolean,default:!1},selectAll:{type:Boolean,default:!0}},{modelValue:{},modelModifiers:{}}),emits:E(["selectClick"],["update:modelValue"]),setup(V,{expose:L,emit:M}){const _=V,k=M,r=G(V,"modelValue"),t=s(""),n=s(!1),N=l=>{n.value=!0},R=W(()=>_.modelValue,()=>{t.value="",r.value&&!t.value&&I("userGet",{id:r.value}).then(l=>{t.value=l.data.userName})}),S=()=>{r.value="",t.value=""},y=s(),A=l=>{y.value=l.id,c.value.getData()},U=(l,e,w)=>{I("deptList",{tid:l.data.id||0}).then(a=>{const p=a.data.list;p.forEach(m=>{m.hasChildren=!m.hasChildren}),e(p||[])})},c=s(),j=(l,e)=>(y.value&&(e.departmentId=y.value,e.status=1),e),z=F(()=>_.multiple),D=s([{prop:"selection",type:"selection",visible:z},{prop:"userName",label:"用户名称"},{label:"操作",render:"buttons",buttons:[{attr:{type:"primary",text:!0},key:"select",label:"选择",click:l=>{t.value=l.userName,r.value=l.id,n.value=!1,k("selectClick",[l])}}]}]),x=s([]),B=l=>{if(l==="all")return k("selectClick",l),b(),!1;const e=c.value.getSelectionRows();e.length>0?(k("selectClick",e),b()):K.error("请选择勾选用户")},b=()=>{n.value=!1,O(()=>{c.value.table?.clearSelection()})},T=l=>{x.value=l};return H(()=>{R()}),L({open:N}),(l,e)=>{const w=d("el-input"),a=d("el-button"),p=d("el-tree"),m=d("ak-list"),$=d("el-dialog");return v(),h("div",null,[l.showInput?(v(),h("div",P,[o(w,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=i=>t.value=i),readonly:"",onClick:e[1]||(e[1]=i=>N()),placeholder:l.placeholder,clearable:!0},null,8,["modelValue","placeholder"]),o(a,{text:"",type:"primary",onClick:S},{default:u(()=>[...e[4]||(e[4]=[f("清空",-1)])]),_:1})])):C("",!0),o($,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value=i),title:"用户选择","append-to-body":!0,width:"800px"},{default:u(()=>[g("div",Q,[g("div",X,[o(p,{ref:"treeEl","node-key":"id",props:{label:"name",value:"id",children:"children",isLeaf:"hasChildren"},"highlight-current":"",onNodeClick:A,load:U,lazy:""},null,512)]),g("div",Y,[o(m,{ref_key:"tableListEl",ref:c,pk:"id",searchIconVisible:!1,columnsIconVisible:!1,before:j,columns:D.value,onSelectionChange:T,api:{list:"userList"}},null,8,["columns"]),l.multiple?(v(),h("div",Z,[l.selectAll?(v(),J(a,{key:0,type:"danger",onClick:e[2]||(e[2]=i=>B("all"))},{default:u(()=>[...e[5]||(e[5]=[f("选择全部",-1)])]),_:1})):C("",!0),o(a,{type:"primary",onClick:B,disabled:!x.value.length},{default:u(()=>[...e[6]||(e[6]=[f("确定",-1)])]),_:1},8,["disabled"]),o(a,{onClick:b},{default:u(()=>[...e[7]||(e[7]=[f("取消",-1)])]),_:1})])):C("",!0)])])]),_:1},8,["modelValue"])])}}});export{le as _};
