import{d as j,k as A,q as y,E as i,Q as G,m as J,e as M,g as s,R as O,r as n,o as P,h as o,i as t,x as b,t as a,n as k,S as d,J as w,_ as Q}from"./index-DuawtOAE.js";import{v as T}from"./validate-DWWidr2n.js";import{_ as W}from"./index.vue_vue_type_script_setup_true_lang-ClFqetln.js";const H=j({__name:"wap",setup(K){const N=A(),_=y(()=>N.getSystemDict()||{}),q=e=>{switch(e){default:return"primary";case 0:return"danger";case 1:return"success"}},u=i(),x=i(),p=i(!0),L=y(()=>p.value?["creatTime","updateTime","lastLogin","loginTimer","ip"]:[]),g=(e,r)=>{O("deptList",{tid:e?.id||0}).then(m=>{const f=m.data?.list||[];f.forEach(c=>{c.hasChildren&&(c.children=[])}),r(f)})},C=i([{prop:"userName",label:"用户名称"},{prop:"phone",label:"手机"},{prop:"weixin",label:"微信"},{prop:"sex",label:"性别",render:"picker",options:"sex",picker:{}},{prop:"status",label:"状态",render:"switch",modelValue:1},{prop:"departmentId",label:"所属部门",render:"cascader",cascader:{lazyLoad:g,fieldNames:{text:"name",value:"id",children:"children"},confirmVisible:!0}},{prop:"roleId",label:"角色权限",render:"picker",picker:{ajax:{api:"roleList",data:{}},columnsFieldNames:{text:"name",value:"id"}}}]),S=e=>{e==="add"&&(p.value=!0)},F=e=>{u.value.showForm(!0),w(()=>{x.value.getData({id:e.id}),p.value=!1,v.value="",w(()=>{})})},I=e=>{u.value.deleteById(e)},v=i(),R=i([{prop:"userName",label:"用户名称",rules:[{required:!0,message:"请填写用户名称"}]},{prop:"password",label:"登录密码",field:{type:"password"}},{prop:"status",label:"状态",render:"switch",modelValue:1},{prop:"sex",label:"性别",render:"picker",options:"sex"},{prop:"phone",label:"手机号码",rules:[T("mobile"),T("required","请输入手机号码")]},{prop:"weixin",label:"微信号码"},{prop:"qq",label:"qq号码"},{prop:"roleId",label:"角色权限",render:"picker",rules:[{required:!0,message:"请选择角色权限"}],picker:{ajax:{api:"roleList",data:{}},columnsFieldNames:{text:"name",value:"id"},multiple:!0}},{prop:"departmentId",label:"所属部门",render:"cascader",cascader:{options:v,lazyLoad:g,fieldNames:{text:"name",value:"id",children:"children"},confirmVisible:!0}},{prop:"tid",label:"直属上级",render:"component",component:G(W)},{prop:"remark",label:"备注",field:{type:"textarea",rows:3,autoSize:!0}},{prop:"creatTime",label:"创建时间",field:{disabled:!0}},{prop:"updateTime",label:"更新时间",field:{disabled:!0}},{prop:"lastLogin",label:"最后登录时间",field:{disabled:!0}},{prop:"loginTimer",label:"登录次数",field:{disabled:!0}},{prop:"ip",label:"最后登录ip",field:{disabled:!0}}]),D=e=>e,V=(e,r)=>{if(e==="submit")h(!1),u.value.onRefresh();else return r.creatTime=d(r?.creatTime),r.updateTime=d(r?.updateTime),r.lastLogin=d(r?.lastLogin),v.value=r.departmentName,r},h=e=>{u.value.showForm(e)};return J(()=>{}),(e,r)=>{const m=n("van-tag"),f=n("van-cell-group"),c=n("van-button"),B=n("van-swipe-cell"),E=n("w-form"),z=n("w-list");return P(),M(z,{ref_key:"listRef",ref:u,api:{get:"userList",del:"userDelete"},"add-icon-visible":!0,"search-form-data":C.value,"form-title":p.value?"新增用户":"编辑用户",onNavBarEvent:S},{item:s(({data:l})=>[o(B,null,{right:s(()=>[o(c,{square:"",type:"primary",text:"修改",onClick:$=>F(l)},null,8,["onClick"]),o(c,{square:"",type:"danger",text:"删除",onClick:$=>I(l.id)},null,8,["onClick"])]),default:s(()=>[o(f,{class:"cell-group"},{default:s(()=>[t("h3",null,[b(a(l.userName)+" ",1),o(m,{type:q(l.sex)},{default:s(()=>[b(a(_.value.sex[l.sex]),1)]),_:2},1032,["type"])]),t("ul",null,[t("li",null,"手机:"+a(l.phone),1),t("li",null,"微信:"+a(l.weixin),1),t("li",null,[r[0]||(r[0]=b(" 状态: ",-1)),o(m,{type:l.status?"primary":"danger"},{default:s(()=>[b(a(_.value.status[l.status]),1)]),_:2},1032,["type"])]),t("li",null,"最后登录:"+a(k(d)(l.lastLogin)),1),t("li",null,"登录次数:"+a(l.loginTimer),1),t("li",null,"登录IP:"+a(l.ip),1),t("li",null,"所属部门:"+a(l.departmentName),1),t("li",null,"创建时间:"+a(k(d)(l.creatTime)),1)])]),_:2},1024)]),_:2},1024)]),default:s(()=>[o(E,{ref_key:"formRef",ref:x,data:R.value,"submit-url":p.value?"userSave":"userEdit","request-url":"userGet",before:D,after:V,"hide-filed":L.value,onCancel:h},null,8,["data","submit-url","hide-filed"])]),_:1},8,["search-form-data","form-title"])}}}),Z=Q(H,[["__scopeId","data-v-fd529818"]]);export{Z as default};
