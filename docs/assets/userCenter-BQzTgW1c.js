import{v as g}from"./validate-DSwcNQEl.js";import{d as B,k as V,E as p,q as F,m as L,P as d,c as f,h as o,n as M,g as r,F as X,j as A,r as s,R as U,T as j,o as i,x as h,t as k,_ as z,ac as w}from"./index-CkpV00AO.js";import{W as O,w as P}from"./wWx-BJhC-L6q.js";const G={key:0,class:"user-center"},H={key:1,style:{background:"#fff",height:"100vh"}},q=B({__name:"userCenter",setup(J){const c=A(),u=V(),m=u.getSystemDict(),l=p(),a=p({}),_=p([{prop:"userName",label:"用户名称",render:"text"},{prop:"statusName",label:"状态",render:"text"},{prop:"sexName",label:"性别",render:"text"},{prop:"tidName",label:"直属上级",render:"text"},{prop:"departmentName",label:"所属部门",render:"text"},{prop:"creatTime",label:"创建时间",render:"text"},{prop:"updateTime",label:"更新时间",render:"text"},{prop:"lastLogin",label:"最后登录时间",render:"text"},{prop:"loginTimer",label:"登录次数",render:"text"},{prop:"ip",label:"最后登录ip",render:"text"},{prop:"phone",label:"手机号码",formItem:{rules:[g("mobile"),g("required","请输入手机号码")]}},{prop:"password",label:"登录密码",attr:{type:"password",placeholder:"不修改请留空"}},{prop:"weixin",label:"微信号码"},{prop:"qq",label:"qq号码"}]),b=(t,e,n)=>(n==="detail"&&(t.statusName=m?.status[t.status],t.sexName=m?.sex[t.sex]),t),x=p(),v=t=>{U("bindWx",t).then(()=>{j.success("绑定成功"),l.value.getData()})},y=()=>{a.value.bindWX?v({unbind:!0}):d()?P("/system/userCenter"):x.value.open()},C=()=>{const t=c.query.code,e=c.query.state;t&&e&&v({code:t})},N=F(()=>{const t=[];return _.value.forEach(e=>{e.formItem?.rules&&(e.rules=e.formItem?.rules,delete e.formItem?.rules),e.prop==="password"&&(e.field={type:"password"},e.placeholder="不修改请留空"),t.push(e)}),t}),R=(t,e,n)=>{b(e,n,"detail"),a.value=e};return L(()=>{l.value.getData(),d()&&(u.setNavBarTitle("个人中心"),u.setRightSearchArrow(!1)),C()}),(t,e)=>{const n=s("el-button"),I=s("el-form-item"),W=s("ak-form"),D=s("van-button"),E=s("van-field"),S=s("w-form");return i(),f(X,null,[M(d)()?(i(),f("div",H,[o(S,{ref_key:"formRef",ref:l,data:N.value,"submit-url":"userEdit","request-url":"userInfo",after:R},{formBottom:r(()=>[o(E,{label:"绑定微信"},{input:r(()=>[o(D,{size:"small",type:"primary",onClick:y},{default:r(()=>[h(k(a.value.bindWX?"解绑":"点击绑定"),1)]),_:1})]),_:1})]),_:1},8,["data"])])):(i(),f("div",G,[o(W,{ref_key:"formRef",ref:l,modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=T=>a.value=T),class:"flex-form flex-form-2",pk:"id","label-width":"120",data:_.value,"label-suffix":"：",after:b,api:{edit:"userEdit",detail:"userInfo"}},{default:r(()=>[o(I,{label:"绑定微信"},{default:r(()=>[o(n,{type:"primary",onClick:y},{default:r(()=>[h(k(a.value.bindWX?"解绑":"点击绑定"),1)]),_:1})]),_:1})]),_:1},8,["modelValue","data"])])),o(O,{ref_key:"scanCodeRef",ref:x,mode:"dialog"},null,512)],64)}}});typeof w=="function"&&w(q);const Z=z(q,[["__scopeId","data-v-adc5a792"]]);export{Z as default};
