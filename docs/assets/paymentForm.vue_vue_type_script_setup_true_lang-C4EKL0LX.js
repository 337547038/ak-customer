import{v as l}from"./validate-DSwcNQEl.js";import{d as U,E as a,q as I,e as _,g as F,J as k,r as i,o as y,f as B,h as E}from"./index-CkpV00AO.js";const R=U({__name:"paymentForm",props:{userId:{default:void 0}},emits:["callback"],setup(g,{expose:x,emit:C}){const f=g,D=C,s=a(!1),n=a(""),o=a({}),p=I(()=>!f.userId&&o.value.status===2),c=a(),u=a(!1),d=()=>{s.value=!1,o.value={},k(()=>{c.value?.resetFields()})},v=a(),V=I(()=>v.value||f.userId),b=a(!1),Y=a([{prop:"code",label:"回款编号",formItem:{rules:[l("required","回款编号不能为空","change")]}},{prop:"contractId",label:"合同",render:"select",formItem:{rules:[l("required","请选择所属合同","change")]},ajax:{api:"contractList",data:{userId:V},label:"name",value:"id"},attr:{disabled:u,clearable:!0}},{prop:"money",label:"回款金额",formItem:{rules:[l("required","回款金额不能为空","change"),l("money")]}},{prop:"account",label:"回款账号",render:"select",options:"accountType",formItem:{rules:[l("required","请选择回款账号","change")]}},{prop:"datetime",label:"回款时间",render:"datePicker",attr:{valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD"},formItem:{rules:[l("required","请输入回款时间","change")]}},{label:"审核",prop:"status",render:"select",options:[{value:1,label:"待审核"},{value:2,label:"通过"},{value:3,label:"拒绝"}],visible:b},{prop:"remark",label:"备注",attr:{style:{width:"100%"},type:"textarea",rows:5}}]),h=(r,e,t)=>{s.value=!0,n.value=r?"修改合同回款":"新增合同回款",t&&(n.value="审批/查看回款详情"),v.value=e?.userId,b.value=!!t,r&&e&&k(()=>{c.value?.getData({id:e.id})}),u.value=!1,!r&&e&&(o.value.contractId=e.id,u.value=!0)},q=(r,e,t)=>{["add","update"].includes(t)&&(d(),D("callback"))};return x({open:h}),(r,e)=>{const t=i("el-alert"),M=i("ak-form"),P=i("el-dialog");return y(),_(P,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=m=>s.value=m),width:"800",title:n.value,class:"form-dialog","destroy-on-close":"","before-close":d},{default:F(()=>[p.value?(y(),_(t,{key:0,title:"审核通过，不能修改数据",type:"success"})):B("",!0),E(M,{ref_key:"formRef",ref:c,modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=m=>o.value=m),disabled:p.value,pk:"id",data:Y.value,"label-width":"110",class:"flex-form flex-form-2",after:q,api:{detail:"contractPaymentGet",add:"contractPaymentSave",edit:"contractPaymentEdit"},onCancel:d},null,8,["modelValue","disabled","data"])]),_:1},8,["modelValue","title"])}}});export{R as _};
