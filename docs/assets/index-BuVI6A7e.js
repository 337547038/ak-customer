import{d as V,E as l,Q as b,V as x,J as S,c as z,e as D,n as B,P as N,h as u,g as R,R as h,r as p,o as _}from"./index-CkpV00AO.js";import{_ as T}from"./index.vue_vue_type_script_setup_true_lang-De22WddW.js";import{_ as q}from"./wap.vue_vue_type_script_setup_true_lang-C4myclVg.js";const w={key:0},$=V({__name:"index",setup(G){const m=l(),k=l([{prop:"name",label:"部门名称"},{prop:"userName",label:"负责人",search:!1},{prop:"status",label:"状态",render:"tag",replaceValue:"status",custom:{1:"success",0:"danger"},search:{render:"select",options:"status"}},{label:"操作",render:"buttons",buttons:[{key:"add",label:"新增",icon:b(x),click:e=>{i(!0,e)}},{key:"edit",label:"编辑",click:e=>{i(!1,e)}},{label:"删除",key:"del",tooltip:"del",popConfirm:{confirmButtonType:"danger"},disabled:e=>e.hasChildren===1}]}]),v=(e,t,o)=>{h("deptList",{tid:e.id}).then(a=>{o(a.data?.list||[])})},y=(e,t)=>(e==="get"&&!t.tid&&(t.tid=0),t),g=l(),s=l(!1),d=l("新增部门"),r=l({status:1}),i=(e,t)=>{s.value=!0,e?(r.value.tid=t?.id||"",d.value="新增部门"):(t?.tid===0&&(t.tid=""),S(()=>{r.value=t||{}}),d.value="修改部门")},f=()=>{s.value=!1},C=()=>{f(),m.value.getData()},L=e=>(e?.tid||(e.tid=0),e),E=l([{prop:"tid",label:"上级部门",render:"tree-select",attr:{placeholder:"请选择上级部门(不选则为顶级)",load:(e,t)=>{h("deptList",{tid:e.data.id||0}).then(o=>{const a=o.data?.list||[];a.forEach(n=>{n.hasChildren=!n.hasChildren}),t(a)})},lazy:!0,checkStrictly:!0,props:{children:"children",label:"name",value:"id",isLeaf:"hasChildren"}}},{label:"部门名称",prop:"name",formItem:{rules:[{required:!0,message:"请输入部门名称",trigger:"blur"}]}},{label:"负责人",prop:"userId",render:"component",component:b(T)},{label:"状态",prop:"status",render:"radio",options:"status"}]);return(e,t)=>{const o=p("ak-list"),a=p("ak-form"),n=p("el-dialog");return B(N)()?(_(),D(q,{key:1})):(_(),z("div",w,[u(o,{ref_key:"tableListEl",ref:m,pk:"id",columns:k.value,api:{list:"deptList",del:"deptDel"},"control-btn":[{key:"add",click:()=>{i(!0)}}],before:y,"table-prop":{rowKey:"id",load:v,lazy:!0,treeProps:{children:"children",hasChildren:"hasChildren"}}},null,8,["columns","control-btn","table-prop"]),u(n,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=c=>s.value=c),width:"500",title:d.value,class:"form-dialog"},{default:R(()=>[u(a,{ref_key:"formEl",ref:g,modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=c=>r.value=c),"label-width":"100px",pk:"id",before:L,after:C,data:E.value,api:{add:"deptSave",edit:"deptEdit",detail:"deptGet"},onCancel:f},null,8,["modelValue","data"])]),_:1},8,["modelValue","title"])]))}}});export{$ as default};
