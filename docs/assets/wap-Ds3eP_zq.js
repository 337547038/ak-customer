import{d as J,k as U,E as s,q as k,j as Z,e as F,g as i,r as u,o as m,h as f,i as o,t as l,x as H,c as g,f as K,Z as O,b as X,F as Y,S as ee,J as te,_ as ae}from"./index-CNiyTwfQ.js";const oe=["onClick"],le={key:0},re={class:"ul"},ne=J({__name:"wap",props:{formData:{}},setup(B){const N=B,y=U(),h=Z(),d=s(),b=s([]),S={1:"是",2:"否",3:"未知"},T=y.userInfo?.hasChild,I=k(()=>y.getSystemDict()||{}),V=k(()=>{const e=[];return N.formData.forEach(a=>{let c=a.render==="radio"?"picker":a.render,n={};switch(a.prop){case"creatDate":case"lastTime":n={field:{disabled:!0}};break;case"tid":c="picker",n={picker:{remote:!0,keyword:"company",ajax:{api:"customerList",data:{}},columnsFieldNames:{text:"company",value:"id"}}};break;case"birthday":n={datePicker:{minDate:new Date(1900,0,1),maxDate:new Date}};break;case"nextTime":n={datePicker:{type:"dateTime"}};break}e.push({label:a.label,prop:a.prop,rules:a.formItem?.rules||[],render:c,options:a.options,...n})}),e}),v=e=>ee(e,"{y}-{m}-{d} {h}:{i}"),q=[{text:"编辑",key:"edit",type:"primary"},{text:"删除",key:"del",type:"danger"}],L=(e,a)=>{a==="del"?d.value.deleteById(e.id):a==="edit"&&(w.value=`编辑：${e.name} 信息`,C(e))},x=s(),E=s([{label:"所属人员",prop:"userId",render:"picker",visible:()=>T,field:{clearable:!0},picker:{ajax:{api:"userChildList",data:{}},columnsFieldNames:{text:"userName",value:"id"}}},{label:"客户名称",prop:"tid",field:{clearable:!0},render:"picker",modelValue:h.query.id,picker:{remote:!0,openLoad:!0,keyword:"company",ajax:{api:"customerList",data:{userId:x}},columnsFieldNames:{text:"company",value:"id"}}},{label:"联系人",prop:"name"},{label:"手机",prop:"phone"},{label:"微信",prop:"weixin"}]),R=(e,a,c)=>{e==="userId"&&(c.tid=""),x.value=a},p=s(!0),w=s("新增联系人"),j=e=>{e==="add"&&(p.value=!0)},M=e=>(e.tid||(e.tid=h.query.id),e),D=s(),C=e=>{p.value=!1,_(!0),te(()=>{D.value.getData({id:e.id})})},$=k(()=>p.value?["lastTime","creatDate"]:[]),_=e=>{d.value.showForm(e)},A=e=>e,P=e=>{e==="submit"&&(d.value.onRefresh(),_(!1))};return(e,a)=>{const c=u("van-collapse-item"),n=u("van-button"),Q=u("van-swipe-cell"),W=u("w-form"),z=u("w-list"),G=u("van-collapse");return m(),F(G,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=t=>b.value=t)},{default:i(()=>[f(z,{ref_key:"listRef",ref:d,api:{get:"contactList",del:"contactDel"},"search-form-data":E.value,"add-icon-visible":!0,"form-title":w.value,before:M,onSearchFormChange:R,onNavBarEvent:j},{item:i(({data:t})=>[f(Q,null,{right:i(()=>[(m(!0),g(Y,null,X(q.filter(r=>r.visible!==!1),r=>(m(),F(n,{key:r.key,square:"",color:r.color,type:r.type,text:r.text,size:"small",onClick:se=>L(t,r.key)},null,8,["color","type","text","onClick"]))),128))]),default:i(()=>[f(c,{name:t.id,value:t.company},{title:i(()=>[o("div",{onClick:O(r=>C(t),["stop"])},[H(l(t.name)+" ",1),t.position?(m(),g("span",le,"("+l(t.position)+")",1)):K("",!0)],8,oe)]),default:i(()=>[o("ul",re,[o("li",null,"手机："+l(t.phone),1),o("li",null,"是否决策人："+l(S[t.decisionMaker]),1),o("li",null,"微信："+l(t.weixin),1),o("li",null,"性别："+l(I.value.sex[t.sex]),1),o("li",null,"电话："+l(t.tel),1),o("li",null,"创建时间："+l(v(t.creatDate)),1),o("li",null,"电子邮箱："+l(t.email),1),o("li",null,"最后联系："+l(v(t.lastTime)),1),o("li",null,"QQ："+l(t.qq),1),o("li",null,"下次联系："+l(v(t.nextTime)),1)])]),_:2},1032,["name","value"])]),_:2},1024)]),default:i(()=>[f(W,{ref_key:"formRef",ref:D,data:V.value,"submit-url":p.value?"contactSave":"contactEdit","request-url":"contactGet",before:A,after:P,"hide-filed":$.value,onCancel:_},null,8,["data","submit-url","hide-filed"])]),_:1},8,["search-form-data","form-title"])]),_:1},8,["modelValue"])}}}),ce=ae(ne,[["__scopeId","data-v-efca53c0"]]);export{ce as default};
